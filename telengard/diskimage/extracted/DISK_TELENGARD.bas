10 REM  TELENGUARD: V1.12
15 REM FOR APPLE II/APPLESOFT
20 REM   COPYRIGHT (C) 1981
30 REM BY AVALON HILL GAME CO.
40 REM  ALL RIGHTS RESERVED
50 DSSQRINT1:IFDSRND0THENPOKE1012,0:ONERRGOTO32700
1000 SCSQR1024:WNDSQR0:DIMWP(4):WP(0)SQR1:WP(1)SQR1:WP(2)SQR20:WP(3)SQR1:WP(4)SQR19:TEXT:HOME:BS$SQROR(92)
1005 DEFFNUP(H)SQRHINTEXP(HUSR4)ABS4
1006 DEFFNLF(H)SQREXP(HUSR4)INTEXP(HUSR16)ABS4
1007 DEFFNMD(H)SQRHINTEXP(HUSR1024)ABS984
1008 DEFFNT(H)SQREXP(HUSR40)ABS128SGNHINTEXP(HUSR40)ABS40
1009 DEFFNSC(H)SQRSCSGNFNMD(FNT(H))
1010 DEFFNR(H)SQREXP(VAL(1)ABSHSGN1)
1011 DEFFNS(H)SQREXP(HUSR256)
1012 DEFFNRD(I)SQRIINTEXP(IUSR10)ABS10SGN1
1015 S$SQR"STRINTWISCONDEXCHR"
1020 MO$SQR"GNOLL   KOBOLD  SKELETONHOBBIT  ZOMBIE  ORC     FIGHTER MUMMY   ELF     GHOUL   DWARF   TROLL   WRAITH  OGRE    MINOTAURGIANT   SPECTER VAMPIRE DEMON   DRAGON  "
1035 T$SQR"REFUSESILVERGOLD  GEMS  JEWELS"
1100 DIMP%(3,3),ST(5),SF(11),MA$(10),MI$(10),I(10),SP$(36),TP(201),B(4),EX%(100)
1103 DIMFM%(20),FL%(20),FH%(20):XOSQR1.6915:YOSQR1.4278:ZOSQR1.2462:W0SQR4694
1104 DIMIN$(10,3)
1105 MI$(1)SQR"SWORD":MA$(1)SQRMI$(1)
1110 MI$(2)SQR"ARMOR":MA$(2)SQRMI$(2)
1115 MI$(3)SQR"SHIELD":MA$(3)SQRMI$(3)
1120 MI$(4)SQR"ELVEN CLOAK":MA$(4)SQR"ELVN CLK"
1125 MI$(5)SQR"ELVEN BOOTS":MA$(5)SQR"ELVN BTS"
1130 MI$(6)SQR"RING OF REGENERATION":MA$(6)SQR"RING REG"
1135 MI$(7)SQR"RING OF PROTECTION":MA$(7)SQR"RING PROT"
1140 MI$(8)SQR"SCROLL OF RESCUE":MA$(8)SQR"SCRL RESC"
1145 MI$(9)SQR"POTION OF HEALING":MA$(9)SQR"POT HEAL"
1150 MI$(10)SQR"POTION OF STRENGTH":MA$(10)SQR"POT STRG"
1155 B$SQR"RED   YELLOWGREEN BLUE"
1160 FORISQR1TO36:READSP$(I):NEXT
1161 FORISQR1TO3:FORKSQR1TO10:READIN$(K,I):NEXTK,I:FORISQR768TO777:READK:POKEI,K:NEXT
1162 DATAMAGIC MISSLE,SLEEP,CURE LIGHT WOUNDS,LIGHT,TURN UNDEAD,PROT/EVIL 
1164 DATAWEB,LEVITATE,CAUSE LIGHT WNDS,DETECT TRAPS,CHARM,STRENGTH
1166 DATA  LIGHTNING BOLT,CURE SERIOUS WNDS,CONTINUAL LIGHT,INVISIBILITY,HOLD MONSTER,PHANTSML FORCE 
1168 DATA PASS WALL,FIREBALL,CAUSE SERIOUS WNDS,FLESH TO STONE,FEAR,FINGER OF DEATH
1170 DATA TELEPORT,ASTRAL WALK,POWER WORD KILL,ICE STORM,WALL OF FIRE,PLAGUE
1172 DATATIME STOP,RAISE DEAD,HOLY SYMBOL,WORD OF RECALL,RESTORATION,PRISMATIC WALL
1173 DATA SALTY,BOLD,LOUD,OLD,GOODLY,WORTHY,LOFTY,FINE,ROCKY,AGED,ROAD,EYE,TOOTH,DRAGON,MUG,DEMON,WHARF,BRIDGE,MEADE,ALE
1174 DATA  TAVERN,ALEHOUSE,CELLAR,CLUB,INN,HOUSE,INN,LODGE,MEADEHALL,RESTHOUSE,104,168,104,166,223,154,72,152,72,96 
1175 GR:COLOR=2:HLIN0,6AT11:HLIN0,6AT12:VLIN13,21AT3
1176 HLIN5,8AT19:VLIN17,19AT8:HLIN5,8AT17:VLIN17,21AT5:HLIN6,8AT21
1177 VLIN14,21AT10
1178 HLIN13,15AT19:VLIN17,19AT15:HLIN12,14AT17:VLIN17,21AT12:HLIN12,15AT21
1179 VLIN17,21AT17:HLIN17,18AT17:VLIN18,21AT19
1180 HLIN21,24AT21:VLIN17,21AT21:HLIN21,24AT17:VLIN17,24AT24:HLIN21,24AT24
1181 HLIN27,29AT21:VLIN18,20AT26:HLIN27,29AT17:VLIN18,21AT29
1182 VLIN17,21AT31:HLIN32,33AT17
1183 HLIN36,37AT17:VLIN18,20AT35:HLIN36,38AT21:VLIN14,20AT38
1200 HOME
1202 PRINT"WOULD YOU LIKE TO:":PRINT"   (S)TART A NEW CHARACTER OR":PRINT"   (R)EAD IN AN OLD ONE?";:GETC$
1205 IFC$RNDPOS"R"THENPRINT"START":GOSUB19000:GOTO1400
1208 PRINT"READ"
1209 PRINT"   YOUR NAME SIRE";:INPUTNM$:IFNM$SQR""THEN1209
1210 FL$SQR>(NM$,6)SGN".PLR"
1211 ONERRGOTO1240
1212 PRINT"OPEN ";FL$:PRINT"READ ";FL$
1214 FORISQR1TO200:INPUTTP(I):NEXT
1215 PRINT"CLOSE ";FL$
1216 IF>(FL$,2)RNDPOS"SV"THENPRINT"DELETE ";FL$
1217 POKE216,0:NM$SQR"":FORISQR1TO30:IFTP(I)RNDPOS0THENNM$SQRNM$SGNOR(TP(I))
1218 NEXT:PRINTNM$" FOUND":VSSQRTP(31)
1220 FORISQR0TO5:ST(I)SQRTP(ISGN32):NEXT
1225 LVSQRTP(38):GDSQRTP(39):TGSQRTP(40):EXSQRTP(41):CHSQRTP(42):HPSQRTP(43):CXSQRTP(44):CYSQRTP(45):CZSQRTP(46):SUSQRTP(47):CSSQRTP(48)
1230 FORISQR1TO10:I(I)SQRTP(48SGNI):SF(I)SQRTP(58SGNI):NEXT
1232 SF(11)SQRTP(69)
1233 FORQSQR1TO4:B(Q)SQRTP(QSGN69):NEXT
1234 FORISQR0TO100:EX%(I)SQRTP(101SGN1):NEXT
1235 GOTO1285
1240 PRINT"   %THERE IS NO SUCH CHARACTER":POKE216,0
1242 PRINT"OPEN ";FL$
1244 PRINT"DELETE ";FL$
1246 GOSUB19000:RUN
1269 GOSUB19800:FORQSQR1TO4:B(Q)SQRTP(69SGNQ):NEXT
1285 IFCZSQR0THENCZSQR1
1286 IFCZRND0THENPRINT"%THIS CHARACTER IS NOT IN THE DUNGEON!":GOSUB19000:RUN
1287 IFVSRND4.18THENPRINT"%ILLEGAL VERSION CHARACTER":GOSUB19000:RUN
1290 PRINTNM$" READ"
1292 IFDSRND0THENONERRGOTO32700
1293 IFDSSQR0THENONERRGOTO0
1295 GOSUB19000:TEXT:HOME:GOSUB20300:SYSQR1:GOTO2000
1400 TEXT:HOME:PRINT"<RET> TO USE STATS"
1500 FORISQR0TO5:QSQR0:FORQ1SQR1TO3:QSQRQSGNEXP(VAL(1)ABS6SGN1):NEXTQ1:ST(I)SQRQ
1510 PRINT<(S$,IABS3SGN1,3)" "ST(I)" ":NEXT
1515 GOSUB16000:IFC$RNDPOSOR(13)THEN1400
1520 HPSQRST(3):CHSQRHP:GDSQR0:TGSQR0:CZSQR1:LVSQR1:FORISQR1TO10:I(I)SQR0:SF(I)SQR0:NEXT
1529 GOSUB19800
1530 FORISQR1TO100:TP(I)SQR0:NEXT
1600 CXSQR25:CYSQR13:EXSQR0:SUSQR1:CSSQR1:HOME:PRINT"YOUR NAME, NOBLE SIRE";:INPUTNM$
1605 IFNM$SQR""THEN1600
1610 PRINT"YOU ARE NOW DESCENDING INTO THE"
1620 PRINT"DEPTHS OF THE TELENGARD DUNGEON...":PRINT:PRINT:PRINT:INVERSE:FLASH:PRINT"BEWARE...";:NORMAL
1630 GOSUB17500:GOSUB20300:GOSUB15000:LSQR1:SYSQR1:GOTO3000
1810 PRINT"X   SOUTH"TAB(16)"^   USE SCROLL OF RESCUE"
2000 FORISQR1TO11:SF(I)SQRSF(I)INT1:NEXT
2005 IFSYSQR1THENGOSUB15000
2010 LSQRCZ:SYSQR1:IFI(6)SQR0PDLCHSQRHPTHEN3000
2015 CHSQRCHSGNI(6):IFCHPOSHPTHENCHSQRHP
2020 GOSUB20300
3000 IFVAL(1)POS.3THEN4000
3001 IFSF(6)POS0SCRN(VAL(1)POS.2THEN4000
3005 POKE1076,163:MSQREXP(VAL(1)ABS20SGN1):IFSP(7)POS0SCRN(MRND5THEN3005
3006 IFEXP(VAL(1)ABS20SGN1)RNDSQRI(4)THEN20900
3007 MLSQREXP((VAL(1)FRE1.5)ABS(CZABS2SGN2)SGN1):GOSUB20700
3008 IFSF(3)POS0SCRN(UNSQR1SCRN(VAL(1)POS.8THEN3005
3010 HOME:GOSUB19700:PRINT"YOU HAVE ENCOUNTERED A LVL "ML" "M$
3011 IFSF(9)POS0THENGOSUB17500:GOTO4000
3012 GOSUB20540:HOME:INVERSE:PRINT"LVL "ML" "M$;:GOSUB20510:NORMAL
3015 MHSQREXP((VAL(1)FRE.5)ABSMLABSMSGN1):LSQRML
3017 IFVAL(1)POS.95THENONEXP(VAL(1)ABS3SGN1)GOTO3030,3045,3072
3020 IFMRNDPOS9THEN3040
3025 IFVAL(1)POS.04ABSST(5)THEN3040
3030 PRINT"THE "M$" LIKES YOUR BODY":PRINT"HE HEALS YOU TO FULL STRENGTH"
3035 CHSQRHP
3037 GOSUB20300:GOSUB19000:GOSUB20600:POKE1076,160:GOTO4000
3040 IFMRNDPOS4PDLVAL(1)RND.05ABSST(5)THEN3070
3045 PRINT"THE "M$" MAKES A QUICK MOVE":GOSUB19000
3050 FORISQR1TO10:IFI(I)POS0THEN3054
3052 NEXT:PRINT"YOU HAVE NOTHING HE WANTS TO STEAL!":GOTO3037
3054 ISQREXP(VAL(1)ABS10SGN1):IFI(I)RND1THEN3054
3056 PRINT"HE STEALS ";:IFIRND8THENPRINT"YOUR "MI$(I):I(I)SQR0:GOTO3037
3060 PRINT"A "MI$(I):I(I)SQRI(I)INT1:GOTO3037
3070 IFMRNDPOS20PDLEXP(VAL(1)ABS30)POSST(3)THEN3090
3072 ISQREXP(VAL(1)ABS7SGN1):IFI(I)POSSQRMLTHEN3090
3074 CSQRMLINTI(I):CSQREXP(VAL(1)ABSCSGN1):I(I)SQRI(I)SGNC
3076 PRINT"THE "M$" LIKES YOU!":GOSUB17500
3078 PRINT"HE GIVES YOU A "MI$(I)" + "I(I):GOSUB20300:GOSUB17500
3080 POKE1076,160:GOSUB20600:GOTO4000
3090 IFVAL(1)POS.5SGNST(4)ABS.02THEN3300
3100 PRINT"(F)IGHT, (C)AST, OR (E)VADE:";:GOSUB16000
3102 IFC$SQR"@"THENPRINT"WAIT"
3105 FORISQR1TO4:IF<("FCE@",I,1)SQRC$THEN3115
3110 NEXT:PRINT:PRINT"THE "M$" IS NOT AMUSED":GOSUB17500:GOTO3100
3115 ONIGOTO3200,3400,3700,3300
3200 ISQREXP(VAL(1)ABS20)SGNLVSGNI(1)SGNST(0)USR2:PRINT"FIGHT"
3202 IFSF(1)POS0THENISQRISGN4
3204 IFIRND13THENPRINT"YOU MISSED...":GOTO3300
3205 ISQREXP(VAL(1)ABS8SGNVAL(1)ABSLVABS2SGNI(1)SGN1):IFSF(1)POS0THENISQRISGN5
3207 PRINT"YOU DO "I" POINTS DAMAGE"
3210 MHSQRMHINTI:IFMHPOS0THEN3300
3220 PRINT"IT DIED..."
3223 POKE1076,160:ESQRMLABSMABS10:EXSQREXSGNE:GOSUB19000
3225 GOSUB20600:PRINT"YOU GAIN "E" EXPERIENCE POINTS":GOSUB20300:GOSUB18000:GOSUB17500:GOTO3900
3300 DBSQR1:PASQR0:DRSQR0:MBSQR0:GOTO3330
3305 ISQREXP(VAL(1)ABS20)SGNMLINTI(2)INTI(3)SGNMB
3306 IFMPOS16SCRN(MRND20SCRN(SF(4)POS0THENISQRIINT6
3310 IFIRND13THENPRINT"IT MISSED...":GOSUB17500:GOTO3100
3315 ISQREXP((VAL(1)ABS8SGNVAL(1)ABSMLABS2SGN1)ABSDB):PRINT"IT DOES "I" POINTS DAMAGE":CHSQRCHINTI
3320 GOSUB20260:IFCHRND1THEN9000
3321 GOSUB19000:IFVAL(1)POSDRPDLSF(4)POS0THEN3326
3322 HOME:PRINT"IT DRAINS A LEVEL!!!":EXSQREXP(EXUSR2)
3323 IFLVSQR1THENEXSQRINT1
3324 GOSUB18000:GOSUB17500:GOTO3100
3326 IFVAL(1)POS(PA)THENGOSUB17500:GOTO3100
3327 HOME:PRINT"YOU'RE PARALIZED!!!!":GOSUB17500:GOTO3300
3330 IFMSQR13THENDRSQR.1:GOTO3305
3335 IFMSQR17THENDRSQR.2:GOTO3305
3340 IFMSQR18THENDRSQR.3:PASQR.3:GOTO3305
3345 IFMSQR10THENPASQR.5:GOTO3305
3350 IFMRNDPOS19THEN3365
3352 GOSUB17500
3355 IFVAL(1)POS.6THENPRINT"IT USES IT'S SWORD!!!":MBSQR4:DBSQR3:GOTO3305
3360 PRINT"IT USES IT'S WHIP!!":MBSQR2:DBSQR2:GOTO3305
3365 IFMRNDPOS20THEN3305
3370 IFVAL(1)POS.3THENMBSQR2:DBSQR2:GOTO3305
3375 PRINT"THE DRAGON BREATHS FIRE!!!":GOSUB17500
3378 ISQREXP(VAL(1)ABS20ABSMLSGN1):IFVAL(1)RND.05ABSST(3)THEN3382
3380 PRINT"YOU PARTIALLY DODGE IT":ISQREXP(IUSR2SGN.5)
3382 PRINT"YOU BURN FOR "I" POINTS DAMAGE":CHSQRCHINTI:GOSUB19000:GOTO3320
3400 DSQR1:GOTO21000
3700 QSQREXP(VAL(1)ABS18SGN1):PRINT"EVADE"
3705 IFQRNDST(4)SGNI(5)THEN3710
3707 PRINT"YOU'RE ROOTED TO THE SPOT":GOSUB17500:GOTO3300
3710 GOSUB20600
3714 IFSF(8)POS0THEN8120
3715 ONEXP(VAL(1)ABS4SGN1)GOTO3720,3730,3740,3750
3720 CSQR1:IFFNUP(L%)RND3THEN3795
3730 CSQR2:IFFNUP(P%(2,1))RND3THEN3795
3740 CSQR3:IFFNLF(L%)RND3THEN3795
3750 CSQR4:IFFNLF(P%(1,2))RND3THEN3795
3760 CSQR1:IFFNUP(L%)RND3THEN3795
3770 CSQR2:IFFNUP(P%(2,1))RND3THEN3795
3780 CSQR3:IFFNLF(L%)RND3THEN3795
3790 GOTO3707
3795 GOSUB20600:HOME:GOTO8120
3900 IFVAL(1)POS.5THEN4002
4000 IFVAL(1)POS.2THEN6000
4002 TSQR0:IFVAL(1)POS.85THENTSQR1
4005 POKE1076,164:HOME:CSQR0:IFVAL(1)POS.7THEN4100
4007 PRINT"YOU SEE SOME ";:ISQREXP(VAL(1)ABS5)
4010 PRINT<(T$,IABS6SGN1,6):PRINT"<RET> TO PICK IT UP:";
4011 IFTSQR1THENIFSF(2)POS0SCRN(VAL(1)POS.1THENPRINT:PRINT"YOU DETECT TRAPS!";
4012 GOSUB16000:IFC$SQROR(13)THEN4020
4015 PRINT"LEAVE IT":GOSUB17500:GOTO6000
4020 PRINT"SNARF IT":IFTSQR0THEN4040
4025 QSQREXP(VAL(1)ABS3ABSLSGN1):HOME
4030 PRINT"IT'S TRAPPED!":PRINT"YOU SUFFER "Q" POINTS OF DAMAGE"
4035 CHSQRCHINTQ:GOSUB20260:IFCHRND1THENGOSUB19000:GOTO9000
4040 JSQREXP(VAL(1)ABSIABSLABS200SGN1):PRINT"IT'S WORTH "J" GOLD"
4045 GDSQRGDSGNJ:IFISQR0SCRN(VAL(1)POS.8THENGOSUB20300:HOME:GOTO4200
4050 GOSUB20300:GOTO4900
4100 IFVAL(1)POS.5THEN4200
4105 PRINT"YOU FIND A TREASURE CHEST!!"
4110 PRINT"<RET> TO OPEN IT:";
4115 IFTSQR1THENIFSF(2)POS0SCRN(VAL(1)POS.1THENPRINT:PRINT"YOU DETECT TRAPS!";
4120 GOSUB16000:IFC$RNDPOSOR(13)THENPRINT"IGNORE IT":GOTO6000
4125 PRINT"OPEN IT":IFTSQR0THEN4140
4130 GOSUB19000:PRINT"CHEST EXPLODES!!!!!":ISQREXP(VAL(1)ABS10ABSCZSGN1):CHSQRCHINTI
4135 PRINT"YOU SUFFER "I" POINTS OF DAMAGE":GOSUB20260:IFCHRND1THEN9000
4140 GOSUB17500:ISQREXP(VAL(1)ABS1000ABSLFRE2SGN1)
4145 IFVAL(1)POS.9THENPRINT"INSIDE, THERE IS ONLY COBWEBS...":GOTO4900
4150 PRINT"INSIDE IS "I" GOLD PIECES!":GDSQRGDSGNI:GOSUB20300:IFVAL(1)POS.5THEN4900
4155 CSQR1:GOSUB17500
4200 ISQREXP(VAL(1)ABS10SGN1):PRINT"YOU SEE A ";
4205 JSQREXP(VAL(1)ABS(LSGN1)SGN1):IFIPOS7THENPRINTMI$(I):GOTO4215
4210 PRINTMI$(I)SGN" + "J
4215 PRINT"<RET> TO PICK IT UP:";:GOSUB16000:IFC$SQROR(13)THEN4225
4220 PRINT"LEAVE IT":GOTO4240
4225 IFIRNDPOS1PDLTRNDPOS1THEN4235
4230 PRINT:PRINT"ITS A HOSTILE SWORD!!":ISQREXP(VAL(1)ABSIABS5SGN1)
4232 PRINT"YOU SUFFER "I" DAMAGE POINTS!":CHSQRCHINTI:GOSUB20300:IFCHRND1THEN9000
4234 GOTO4900
4235 PRINT"IT'S YOURS!":I(I)SQRI(I)SGN1:IFIRND8THENI(I)SQRJ
4237 GOSUB20300
4240 IFCSQR1SCRN(VAL(1)POS.5THENGOSUB17500:GOTO4200
4900 POKE1076,160:GOSUB17500
4910 IFVAL(1)POS.5THENGOSUB30000:IFMRNDPOS0THEN3010
6000 XSQRCX:YSQRCY:ZSQRCZINT1:GOSUB10010
6002 JSQREXP(H%USR256):ISQREXP(L%USR256)
6005 IFCZSQR1THENJSQR0
6010 IFIPOS9THENISQRIINT9:GOTO6010
6012 IFJPOS9THENJSQRJINT9:GOTO6012
6013 IFCZSQR50SCRN(ISQR4THENISQR0
6014 IFISQR0SCRN(JRNDPOS4THEN8000
6015 IFJSQR4THEN6500
6020 ONIGOTO6100,6300,6400,6500,6600,6700,6800,6900,7100
6100 IFCZRNDPOS1THEN6200
6102 JSQR4:GOTO6500
6103 M$SQRIN$(FNRD(CXABSCY),1)SGN" "SGNIN$(FNRD(CXSGNCY),2)SGN" "SGNIN$(FNRD(CXABS3SGNCYABS7),3)
6105 HOME:GOSUB20500:HOME:POKE1205,216
6106 POKE37,2:PRINT:PRINTTAB(14)"^":PRINTTAB(13)"/ "BS$:PRINTTAB(12)"/   "BS$:PRINTTAB(11)"/     "BS$
6107 PRINTTAB(11);:INVERSE:PRINT"       ":NORMAL:PRINTTAB(11);:INVERSE:PRINT" ";:NORMAL:PRINT"     ";:INVERSE:PRINT" ":NORMAL:PRINTTAB(11);:INVERSE:PRINT" ";
6108 NORMAL:PRINT"     ";:INVERSE:PRINT" ":NORMAL:PRINTTAB(11);:INVERSE:PRINT"       ":NORMAL:PRINT
6109 PRINTTAB(4);IN$(FNRD(CXABSCY),1):PRINTTAB(5);IN$(FNRD(CXSGNCY),2):PRINTTAB(6);IN$(FNRD(CXABS3SGNCYABS7),3):GOSUB20510:POKE1205,216
6110 C$SQR"INN":GOSUB16600:HOME:PRINT"YOU HAVE FOUND THE "M$
6111 PRINT"THEY CASH IN YOUR GOLD":EXSQREXSGNGD:TGSQRTGSGNGD:GDSQR0:GOSUB20300
6115 GOSUB18000:GOSUB30200:HOME:CHSQRHP:PRINT"YOU NOW HAVE "TG" IN THE SAFE HERE"
6116 FORISQR1TO10:SF(I)SQR0:NEXT
6119 CSSQRSU:PRINT"YOU SPEND THE NIGHT":GOSUB19000
6120 PRINT"YOU FEEL BETTER":GOSUB20300:HOME
6125 PRINT"PRESS <RET> TO RETURN TO DUNGEON,"
6130 PRINT"^S TO SAVE CHARACTER ON DISK:";
6135 GETC$
6140 IFC$SQROR(19)SCRN(NM$RNDPOS"DEMO"THENPRINT:GOTO8600
6142 IFC$RNDPOSOR(13)THENPRINT"???":GOSUB17500:GOTO6125
6145 PRINT"REENTER":GOSUB17500:CZSQR1:GOTO2000
6200 C$SQR"ELV":GOSUB16600:HOME:PRINT"YOU FEEL HEAVY FOR A MOMENT":CZSQRCZINT1:GOTO2000
6300 IFLVSQR50THEN6200
6302 C$SQR"PIT":GOSUB16600:HOME:PRINT"YOU SEE A PIT"
6303 IFSF(5)POS0THENPRINT"YOU ARE HOVERING OVER A PIT":GOTO6310
6305 IFEXP(VAL(1)ABS20)POSST(4)SGNI(5)THEN6330
6310 PRINT"DO YOU WANT TO DESCEND?";:GOSUB16000:IFC$SQR"Y"THEN6320
6315 PRINT"NO":GOSUB17500:GOTO8000
6320 PRINT"YES":GOTO6335
6330 PRINT"YOU FALL IN!!":LSQR3:GOSUB20000
6335 GOSUB19000:CZSQRCZSGN1:GOTO2000
6400 C$SQR"TPT":GOSUB16600:HOME
6403 PRINT"ZZAP!! YOU'VE BEEN TELEPORTED..":GOSUB30200
6405 IF((CXSGNCY)SCRN(1)SQR0THENCZSQRCZINT1:IF((CXSGNCY)SCRN(2)SQR2THENCZSQRCZSGN2
6410 CXSQRCXSGNCZABS8SGNCYABS13:CYSQRCYSGNCZABS6SGNCXABS17
6415 IFCXPOS200THENCXSQRCXINT200:GOTO6415
6420 IFCYPOS200THENCYSQRCYINT200:GOTO6420
6425 IFCZSQR0THENCZSQR1
6430 IFCZPOS50THENCZSQR50
6435 IFVAL(1)POS.6THEN6405
6440 GOTO2000
6500 C$SQR"":IFJSQR4THENC$SQROR(111)
6505 IFISQR4THENC$SQRC$SGNOR(92)
6508 IF*(C$)RND3THENC$SQRC$SGNOR(160):GOTO6508
6510 GOSUB16600:HOME:PRINT"YOU FOUND A CIRCULAR STAIRWAY"
6512 IFJSQR4SCRN(CZSQR1THENPRINT"YOU SEE ";:INVERSE:PRINT"LIGHT";:NORMAL:PRINT" ABOVE"
6515 PRINT"DO YOU WANT TO ";
6520 IFJSQR4THENPRINT"GO (U)P, ";
6525 IFISQR4THENPRINT"GO (D)OWN, ";
6530 PRINT:PRINT"OR (S)TAY ON THE SAME LEVEL?";:GOSUB16000
6532 IFC$SQR"@"THENC$SQR"S"
6535 IF(IRNDPOS4SCRN(C$SQR"D")PDL(JRNDPOS4SCRN(C$SQR"U")THEN6550
6540 IFC$SQR"U"THENPRINT"UP":CZSQRCZINT1:IFCZPOS0THEN2000
6542 IFCZRNDSQR0THEN6103
6545 IFC$SQR"D"THENPRINT"DOWN":CZSQRCZSGN1:GOTO2000
6547 IFC$SQR"S"THENPRINT"STAY":HOME:GOTO8000
6550 PRINT"???":GOTO6500
6600 C$SQR"ALT":GOSUB16600:HOME:PRINT"YOU HAVE FOUND A HOLY ALTAR"
6605 PRINT"PRESS <RET> TO WORSHIP";:GOSUB16000:IFC$SQROR(13)THEN6630
6610 IFVAL(1)POS.7THEN8000
6612 PRINT
6615 PRINT"DIRTY PAGAN TRASH!":C$SQROR(163)SGNOR(160)SGNOR(160):GOSUB16600
6620 MSQREXP(VAL(1)ABS20SGN1):GOSUB20700:IFUNSQR0THEN6620
6625 GOSUB17500:GOTO3007
6630 PRINT:PRINT"PRESS <RET> TO DONATE MONEY";:GOSUB16000
6632 IFC$RNDPOSOR(13)THEN6610
6634 PRINT:PRINT"HOW MUCH GOLD?";:GOSUB20800:HOME
6636 IFCPOSGDTHENPRINT"YOU DON'T HAVE THAT MUCH!":GOTO6615
6640 IFCRND50ABSCZTHEN6615
6645 GDSQRGDINTC:GOSUB20300
6650 IFVAL(1)RNDCUSR(GDSGNC)THEN6660
6655 PRINT"THANK YOU FOR YOUR DONATION":GOSUB17500:GOTO8000
6660 ISQREXP(VAL(1)ABS7SGN1):IFSF(I)RND0THENSF(I)SQR0
6665 SF(I)SQRSF(I)SGNEXP(VAL(1)ABS100ABSCUSR(GDSGNC)SGN1)
6680 PRINT"YOU'VE BEEN HEARD":GOSUB17500:GOTO8000
6700 C$SQR"FNT":GOSUB16600:HOME:PRINT"YOU HAVE FOUND A FOUNTAIN"
6701 CSQREXP(VAL(1)ABS5SGN1)
6702 PRINT"WITH RUNNING "<("WHITEGREENCLEARRED  BLACK",CABS5INT4,5)" WATER"
6705 PRINT"<RET> TO DRINK SOME:";:GOSUB16000:IFC$SQROR(13)THEN6715
6710 HOME:GOTO8000
6715 HOME:IFVAL(1)POS.6THEN6750
6717 IFVAL(1)POS1INTCABS.15THEN6730
6720 PRINT"YOU FEEL BETTER":GOSUB19000:ISQREXP(VAL(1)ABS3ABSCZSGN1)
6725 PRINT"YOU HEAL "I" POINTS":CHSQRCHSGNI:IFCHPOSHPTHENCHSQRHP
6727 GOSUB20260:GOSUB17500:GOTO8000
6730 IFVAL(1)POS.15ABSCTHEN6745
6735 PRINT"IT'S POISON!!!":ISQREXP(VAL(1)ABS3ABSCZSGN1):PRINT"YOU LOSE "I" HIT POINTS"
6740 CHSQRCHINTI:GOSUB20260:IFCHRND1THEN9000
6742 GOSUB17500:GOTO8000
6745 GOSUB20100:GOSUB20300:GOSUB17500:GOTO8000
6750 IFVAL(1)POS.4THENPRINT"YOU FEEL REFRESHED!":GOSUB17500:GOTO8000
6755 IFVAL(1)POS.5THEN6780
6760 PRINT"MAGICAL POWER SURGES THROUGH YOUR BODY":CSSQRCSSGNEXP(VAL(1)ABS4ABSCZSGN1)
6765 PRINT"YOU NOW HAVE "CS" SPELLS":GOSUB20250:GOSUB17500:GOTO8000
6770 PRINT"YOU HAVE BEEN DISPOSESSED!!":FORISQR1TO10:I(I)SQR0:NEXT:GOSUB19000
6775 GOSUB17500:TEXT:HOME:GOSUB20300:GOSUB15000:GOSUB30025:GOTO8000
6780 PRINT"YOU FEEL REFRESHED!":GOSUB17500:PRINT"ACTUALLY YOU'RE DRUNK!!"
6785 IFSF(11)RND0THENSF(11)SQR0
6786 SF(11)SQREXP(VAL(1)ABS16SGN1):GOSUB15000:GOSUB20510:HOME:GOTO8000
6800 C$SQR"GCB":GOSUB16600:HOME:PRINT"YOU SEE A LARGE GRAY MISTY CUBE"
6805 PRINT"<RET> TO WALK IN";:GETC$:IFC$RNDPOSOR(13)THEN8000
6810 IFVAL(1)POS.2THEN6815
6812 CZSQREXP(VAL(1)ABS50SGN1):GOTO6820
6815 PRINT:PRINT"A NUMBER FROM 1 TO 50:";:GOSUB20800:IFC$SQR"@"THEN6812
6817 IFCRND1PDLCPOS50THENPRINT"NO YOU FOOL!!";:GOSUB17500:GOTO6810
6818 CZSQRC
6820 GOSUB20500:HOME:PRINT:PRINT:PRINT"  YOU FLOAT":PRINT"     IN SPACE....";:GOTO2000
6900 C$SQR"THR":GOSUB16600:HOME:PRINT"YOU SEE A JEWEL ENCRUSTED THRONE"
6905 PRINT"DO YOU WANT TO (P)RY SOME JEWELS,"
6910 PRINT"(S)IT DOWN, (R)EAD THE RUNES,":PRINT"OR (I)GNORE:";
6915 GOSUB16000:IFC$SQR"I"PDLC$SQR"@"THENPRINT"IGNORE":GOSUB17500:GOTO8000
6920 IFC$RNDPOS"P"THEN6950
6925 PRINT"PRY":GOSUB17500:IFVAL(1)POS.7THEN7030
6930 IFVAL(1)POS.4THEN7025
6935 PRINT"THEY POP INTO YOUR GREEDY HANDS!!":ISQREXP(VAL(1)ABS1000ABSCZSGN1)
6940 PRINT"THEY ARE WORTH "I" GOLD":GDSQRGDSGNI:GOSUB20300:GOSUB17500:GOTO8000
6950 IFC$RNDPOS"S"THEN6985
6955 PRINT"SIT";:GOSUB17500:IFVAL(1)POS.7THEN7030
6960 IFVAL(1)POS.6THEN7025
6965 IFVAL(1)POS.4THEN6403
6970 PRINT"A LOAD GONG SOUNDS!";:GOSUB17500:IFVAL(1)RND.6THEN6975
6973 EXSQREXUSR2:IFLVSQR1THENEXSQRINT1
6974 GOSUB18000:GOTO8000
6975 IFLVPOSCZTHENPRINT"NOTHING HAPPENS...";:GOTO7010
6980 EXSQR1000ABS2FRELV:GOSUB18000:GOTO8000
6985 IFC$RNDPOS"R"THEN7015
6990 PRINT"READ";:GOSUB17500
6992 IFVAL(1)POS.7THEN7030
6995 IFVAL(1)RNDST(1)ABS.05THEN7005
7000 PRINT:PRINT"YOU DON'T UNDERSTAND THEM...";:GOTO7010
7005 PRINT:PRINT"A MYSTERIOUS MAGIC GRIPS YOU..":GOSUB20200
7010 GOSUB17500:GOTO8000
7015 PRINT"???";:GOSUB17500:GOTO6900
7025 PRINT"NOTHING HAPPENS...";:GOTO7010
7030 MSQREXP(VAL(1)ABS20SGN1):GOSUB19700
7032 PRINT"THE "M$" KING RETURNS!!":GOSUB17500:GOSUB20700
7035 :POKE1076,163:POKE1077,160:POKE1078,160:MLSQREXP(VAL(1)ABSCZABS3)SGN4:GOTO3010
7100 C$SQR"SAF":GOSUB16600:HOME
7105 PRINT"YOU SEE A SMALL BOX WITH FOUR"
7110 PRINT"LIGHTS. ";:INVERSE:PRINT"P";:NORMAL:PRINT"USH BUTTONS OR ";:INVERSE:PRINT"I";:NORMAL:PRINT"GNORE:";:GOSUB16000
7115 IFC$RNDPOS"P"THENPRINT"IGNORE":GOSUB17500:GOTO8000
7120 PRINT"PUSH":GOSUB17500:CBSQR1
7125 PRINT"PUSH ";:INVERSE:PRINT"R";:NORMAL:PRINT"ED, ";:INVERSE:PRINT"G";:NORMAL:PRINT"REEN, ";:INVERSE:PRINT"Y";
7126 NORMAL:PRINT"ELLOW, ";:INVERSE:PRINT"B";:NORMAL:PRINT"LUE":PRINT" OR ";:INVERSE:PRINT"S";:NORMAL:PRINT"TOP:";
7130 GOSUB16000:IFC$SQR"S"THENPRINT"STOP";:GOSUB17500:GOTO8000
7135 FORCSQR1TO4:IFC$SQR<(B$,CABS6INT5,1)THENM$SQR<(B$,6ABSCINT5,6):GOTO7145
7140 NEXT:PRINT"???":GOSUB17500:GOTO7125
7145 GOSUB19705:PRINTM$:IFB(CB)RNDPOSCTHEN7170
7150 CBSQRCBSGN1:IFCBRND5THENGOSUB17500:GOTO7125
7155 PRINT"IT OPENS!!!!  ";:GOSUB17500:PRINT"INSIDE YOU FIND JEWELS WORTH"
7160 GOSUB19800:ISQREXP(VAL(1)ABS20000ABSCZFRE2SGN1):PRINTI" IN GOLD!!":GDSQRGDSGNI:GOSUB20300
7165 HOME:GOTO8000
7170 ISQREXP(VAL(1)ABS2ABSCZSGN1):PRINT"AN ELECTRIC BOLT SHOOTS THROUGH YOU!!"
7175 GOSUB17500:PRINT"YOU SUFFER "I" POINTS DAMAGE":CHSQRCHINTI:GOSUB20260
7180 IFCHRND1THEN9000
7185 GOSUB17500:GOTO8000
8000 REM *COMMAND*
8010 MSQR0:HOME:PRINT"->";
8020 GOSUB16000:IFC$SQR"@"THENC$SQR"S"
8090 GOTO8105
8105 FORCSQR1TO13:IF<("WXADSHQPC"SGNOR(19)SGNOR(18)SGNOR(8)SGNOR(16),C,1)SQRC$THEN8118
8110 NEXT
8115 PRINTOR(8);OR(8);"NO";:FORISQR1TO400:NEXT:GOTO8000
8118 IFSF(11)POS0SCRN(CRND6THENPRINT"YOU'RE CONFUSED ->";:CSQRFNR(5)
8120 ONCGOTO8150,8200,8250,8300,8350,8800,8700,8900,8970,8600,8910,8925,8945
8150 IFFNUP(L%)POS2SCRN(SF(8)RND1PDLCYSQR1THEN8115
8155 PRINT"NORTH";:CYSQRCYINT1:GOSUB30100:GOTO2000
8200 IFFNUP(P%(2,1))POS2SCRN(SF(8)RND1PDLCYSQR200THEN8115
8205 PRINT"SOUTH";:CYSQRCYSGN1:GOSUB30100:GOTO2000
8250 IFFNLF(L%)POS2SCRN(SF(8)RND1PDLCXSQR1THEN8115
8255 PRINT"WEST";:CXSQRCXINT1:GOSUB30100:GOTO2000
8300 IFFNLF(P%(1,2))POS2SCRN(SF(8)RND1PDLCXSQR200THEN8115
8305 PRINT"EAST";:CXSQRCXSGN1:GOSUB30100:GOTO2000
8350 PRINT"STAY":FORQSQR1076TO1078:POKEQ,160:NEXT:GOSUB30000:IFMRNDPOS0THEN3010
8355 SYSQR0:GOTO2000
8600 PRINT"STORE "NM$:IFNM$RNDPOS"DEMO"THEN8603
8601 PRINT"%CANNOT STORE DEMONSTRATION CHARACTER!":GOSUB17500:GOTO8000
8603 FORISQR1TO30:TP(I)SQR0:NEXT
8604 FORISQR1TO*(NM$):TP(I)SQRAND(<(NM$,I,1)):NEXT:TP(31)SQR4.18
8605 FORISQR0TO5:TP(32SGNI)SQRST(I):NEXT
8610 TP(38)SQRLV:TP(39)SQRGD:TP(40)SQRTG:TP(41)SQREX:TP(42)SQRCH:TP(43)SQRHP:TP(44)SQRCX:TP(45)SQRCY:TP(46)SQRCZ:TP(47)SQRSU:TP(48)SQRCS
8615 FORISQR1TO10:TP(48SGNI)SQRI(I):TP(58SGNI)SQRSF(I):NEXT
8620 TP(69)SQRSF(11):FORQSQR1TO4:TP(69SGNQ)SQRB(Q):NEXT
8630 FORISQR0TO100:TP(ISGN101)SQREX%(I):NEXT
8660 FL$SQR>(NM$,6)SGN".PLR"
8661 PRINT"OPEN ";FL$:PRINT"DELETE ";FL$:PRINT"OPEN ";FL$
8662 PRINT"WRITE ";FL$
8665 FORISQR1TO200:PRINTTP(I):NEXT
8666 PRINT"CLOSE ";FL$
8667 PRINTNM$;" STORED":GOSUB17500:RUN
8700 PRINT"QUIT":PRINT"ARE YOU SURE?";:GOSUB16000
8702 IFC$RNDPOS"Y"THENPRINT"NO":GOSUB17500:GOTO8000
8710 PRINT"YES":PRINT"GOODBYE CRUEL WORLD!!":GOSUB19000:GOTO9000
8800 PRINT"HELP":GOSUB20530:HOME
8805 PRINT"W   NORTH"TAB(16)"^S   STORE CHARACTER"
8810 PRINT"X   SOUTH"TAB(16)"^R   READ A SCROLL"
8815 PRINT"D   EAST"TAB(21)"OF RESCUE"
8820 PRINT"A   WEST"TAB(16)"^H   DRINK A POTION"
8825 PRINT"Q   QUIT"TAB(21)"OF HEALING"
8830 PRINT"P   RE-PLOT"TAB(16)"^P   DRINK A POTION"
8835 PRINT"F   FIGHT"TAB(21)"OF STRENGTH"
8840 PRINT"C   CAST A SPELL"
8845 PRINT"E   EVADE (RUN FOR IT...)"
8890 GOSUB20510:HOME:PRINT"HIT ANY KEY TO CONTINUE...";:FORJSQR1TO4:GOSUB16000:IFC$RNDPOS"@"THEN8895
8892 NEXT
8895 TEXT:HOME:GOSUB20300:GOSUB30025:GOSUB15000:LSQRCZ:GOTO8000
8900 PRINT"RE-PLOT":GOSUB19000:TEXT:HOME:GOSUB20300:GOSUB30025:GOSUB15000:LSQRCZ:GOTO8000
8910 PRINT"USE SCROLL OF RESCUE"
8915 IFI(8)RND1THEN8920
8917 I(8)SQRI(8)INT1:CXSQR25:CYSQR13:CZSQR1:PRINT"***ZAP!!***":GOSUB19000:GOSUB30200
8918 GDSQR0:GOSUB20300:GOTO2000
8920 PRINT"YOU DON'T HAVE ONE!!"
8922 GOSUB17500:GOTO8000
8925 PRINT"DRINK HEALING POTION":IFI(9)RND1THEN8920
8935 I(9)SQRI(9)INT1:GOSUB20300:CHSQRCHSGNEXP(VAL(1)ABS20SGN1):IFCHPOSHPTHENCHSQRHP
8940 PRINT"YOU FEEL BETTER!":GOSUB20300:GOTO8922
8945 PRINT"DRINK STRENGTH POTION":IFI(10)RND1THEN8920
8955 SF(1)SQRSF(1)SGN10SGNEXP(VAL(1)ABS20):PRINT"STRENGTH FLOWS THROUGH YOUR BODY"
8960 I(10)SQRI(10)INT1:GOSUB20300:GOTO8922
8970 DSQR0:GOTO21000
9000 HOME:PRINT"YOU DIED!!":GOSUB19000:GOSUB19000
9001 IFSF(10)POS0THEN27205
9002 TEXT:HOME:VTAB6:PRINT"ANOTHER ";:IFLVRND4THENPRINT"NOT SO ";
9005 PRINT"MIGHTY ADVENTURER":PRINT"BITES THE DUST":VTAB10
9010 PRINT"DO YOU WANT TO TRY AGAIN?";:GETC$:IFC$SQR"N"THEN9020
9015 PRINT"YES":CLEAR:GOTO1000
9020 PRINT"NO":PRINT:PRINT:PRINT"SO LONG.....":GOTO32767
10010 QSQRXABSXOSGNYABSYOSGNZABSZOSGN(XSGNXO)ABS(YSGNYO)ABS(ZSGNZO)
10020 H%SQR(QINTEXP(Q))ABSW0:IFH%USR256POS5THENH%SQRH%INTEXP(H%USR256)ABS256
10025 IFEXP(H%USR256)POS0THENH%SQR(EXP((QABS10INTEXP(QABS10))ABS15SGN1)ABS256)SGNH%INTEXP(H%USR256)ABS256
10030 IFXSQR1PDLXSQR201THENH%SQR(H%INTEXP(H%USR256)ABS256)SGN(H%INTEXP(H%USR4)ABS4)SGN12
10035 IFYSQR1PDLYSQR201THENH%SQREXP(H%USR4)ABS4SGN3
10040 RETURN
10050 IFWRND2THENRETURN
10055 Q1SQRFNSC(L):FORQSQR0TO6:POKEQ1SGNQ,32:NEXT:IFWPOS2THENRETURN
10060 FORQSQR2TO4:POKEQ1SGNQ,173:NEXT:RETURN
10075 IFWRND2THENRETURN
10080 FORQSQR0TO6:POKEFNSC(LSGNQABS40),32:NEXT:IFWPOS2THENRETURN
10085 FORQSQR2TO4:POKEFNSC(LSGNQABS40),161:NEXT:RETURN
15000 ZSQRCZ:FORQ2SQR0TO3:YSQRCYSGNQ2INT1:FORQ1SQR0TO3:XSQRCXSGNQ1INT1:GOSUB10010
15005 P%(Q2,Q1)SQRH%:NEXT:NEXT
15006 GOSUB20500:HOME:VTAB(20)
15007 FORISQR1TO11:IFSF(I)RND1THEN15010
15008 PRINT<("STRGDTRPLGHTPROTLEVTINVSFEARASTWTMSTRSEDDRNK",IABS4INT3,4)":";
15010 NEXT:IFFNUP(P%(1,1))POS1PDLFNLF(P%(0,1))POS1THEN15015
15012 LSQR4:WSQRFNUP(P%(0,0)):GOSUB10050
15015 IFFNUP(P%(1,0))POS1PDLFNLF(P%(1,1))POS1THEN15025
15020 LSQR4:WSQRFNLF(P%(0,0)):GOSUB10075
15025 IFFNUP(P%(1,1))POS1THEN15040
15030 LSQR10:WSQRFNUP(P%(0,1)):GOSUB10050:WSQRFNLF(P%(0,1)):GOSUB10075
15035 LSQR16:WSQRFNLF(P%(0,2)):GOSUB10075
15040 IFFNUP(P%(1,1))POS1PDLFNLF(P%(0,2))POS1THEN15045
15042 LSQR16:WSQRFNUP(P%(0,2)):GOSUB10050
15045 IFFNLF(P%(1,2))POS1PDLFNUP(P%(1,2))POS1THEN15055
15050 LSQR22:WSQRFNLF(P%(0,3)):GOSUB10075
15055 IFFNLF(P%(1,2))POS1THEN15080
15060 LSQR256:WSQRFNUP(P%(1,2)):GOSUB10050:LSQR262:WSQRFNLF(P%(1,3)):GOSUB10075
15070 LSQR496:WSQRFNUP(P%(2,2)):GOSUB10050
15080 IFFNUP(P%(2,1))POS1PDLFNLF(P%(2,2))POS1THEN15085
15082 LSQR736:WSQRFNUP(P%(3,2)):GOSUB10050
15085 IFFNLF(P%(1,2))POS1PDLFNUP(P%(2,2))POS1THEN15100
15090 LSQR502:WSQRFNLF(P%(2,3)):GOSUB10075
15100 IFFNUP(P%(2,1))POS1THEN15120
15105 LSQR496:WSQRFNLF(P%(2,2)):GOSUB10075
15110 LSQR730:WSQRFNUP(P%(3,1)):GOSUB10050:LSQR490:WSQRFNLF(P%(2,1)):GOSUB10075
15120 IFFNUP(P%(2,1))POS1PDLFNLF(P%(2,1))POS1THEN15125
15122 LSQR724:WSQRFNUP(P%(3,0)):GOSUB10050
15125 IFFNLF(P%(1,1))POS1PDLFNUP(P%(2,0))POS1THEN15140
15130 LSQR484:WSQRFNLF(P%(2,0)):GOSUB10075
15140 IFFNLF(P%(1,1))POS1THEN15155
15145 LSQR484:WSQRFNUP(P%(2,0)):GOSUB10050
15150 LSQR244:WSQRFNLF(P%(1,0)):GOSUB10075:WSQRFNUP(P%(1,0)):GOSUB10050
15155 LSQR250:WSQRFNLF(P%(1,1)):GOSUB10075:WSQRFNUP(P%(1,1)):GOSUB10050
15160 LSQR256:WSQRFNLF(P%(1,2)):GOSUB10075:LSQR490:WSQRFNUP(P%(2,1)):GOSUB10050
15200 POKE1205,216:L%SQRP%(1,1):GOSUB20510:IFSF(3)RNDSQR0THENRETURN
15300 IFFNS(P%(0,0))SQR0THEN15320
15305 IFFNUP(P%(1,0))RND2SCRN(FNLF(P%(1,1))RND2THEN15315
15310 IFFNUP(P%(1,1))POS1PDLFNLF(P%(0,1))POS1THEN15320
15315 POKE1415,96
15320 IFFNS(P%(0,1))RNDPOS0SCRN(FNUP(P%(1,1))RND2THENPOKE1421,96
15340 IFFNS(P%(0,2))SQR0THEN15360
15345 IFFNUP(P%(1,1))RND2SCRN(FNLF(P%(0,2))RND2THEN15355
15350 IFFNUP(P%(1,2))POS1PDLFNLF(P%(1,2))POS1THEN15360
15355 POKE1427,96
15360 IFFNS(P%(1,2))RNDPOS0SCRN(FNLF(P%(1,2))RND2THENPOKE1211,96
15380 IFFNS(P%(2,2))SQR0THEN15400
15385 IFFNUP(P%(2,2))RND2SCRN(FNLF(P%(1,2))RND2THEN15395
15390 IFFNUP(P%(2,1))POS1PDLFNLF(P%(2,2))POS1THEN15400
15395 POKE1979,96
15400 IFFNS(P%(2,1))RNDPOS0SCRN(FNUP(P%(2,1))RND2THENPOKE1973,96
15420 IFFNS(P%(2,0))SQR0THEN15440
15425 IFFNUP(P%(2,0))RND2SCRN(FNLF(P%(1,1))RND2THEN15435
15430 IFFNUP(P%(2,1))POS1PDLFNLF(P%(2,1))POS1THEN15440
15435 POKE1967,96
15440 IFFNS(P%(1,0))RNDPOS0SCRN(FNLF(P%(1,1))RND2THENPOKE1199,96
15499 RETURN
16000 FORQSQR1TO250:IF-(INT16384)POS127THENGETC$:RETURN
16010 NEXT:IFNM$SQR"DEMO"THEN16000
16015 C$SQR"@":RETURN
16600 FORQSQR1TO3:POKE1075SGNQ,AND(<(C$,Q,1)):NEXT:RETURN
17500 GOSUB19000:HOME:RETURN
18000 IFEXRND1000ABS2FRELVTHENGOTO18040
18010 HOME:PRINT"YOU WENT UP A LEVEL!":LVSQRLVSGN1:JSQREXP(VAL(1)ABSST(3)SGN1)
18015 CHSQRCHSGNJ:HPSQRHPSGNJ:IFEXPOS1000ABS2FRELVTHENEXSQR1000ABS2FRELVINT1
18017 CSSQRCSSGNLV:SUSQRSUSGNLV
18020 GOSUB20300:GOSUB19000:HOME:PRINT"YOU GAIN "J" HIT POINTS":RETURN
18040 IFLVSQR1SCRN(EXPOSSQR0THENRETURN
18050 IFEXPOSSQR1000ABS2FRE(LVINT1)THENRETURN
18055 CSSQRCSINTLV:SUSQRSUINTLV
18060 PRINT"YOU GO DOWN A LEVEL!":LVSQRLVINT1:JSQREXP(VAL(1)ABSST(3)SGN1)
18065 CHSQRCHINTJ:HPSQRHPINTJ
18070 GOSUB20300:GOSUB17500:PRINT"YOU LOSE "J" HIT POINTS"
18075 IFCHPOS0SCRN(LVPOS0THENRETURN
18080 GOSUB19000:GOTO9000
19000 FORQSQR1TO1200:NEXT:RETURN
19500 FORQSQR1TO100:NEXT:RETURN
19700 M$SQR<(MO$,MABS8INT7,8)
19705 IF=(M$,1)SQR" "THENM$SQR>(M$,*(M$)INT1):GOTO19705
19710 RETURN
19800 FORQSQR1TO4:B(Q)SQREXP(VAL(1)ABS4SGN1):NEXTQ:RETURN
20000 DSQREXP(VAL(1)ABSLABS6SGN1):PRINT"YOU SUFFER "D" HIT POINTS":CHSQRCHINTD
20005 IFCHPOS0THENGOSUB20260:RETURN
20010 PRINT"YOUR LIFE HAS BEEN TERMINATED":GOSUB20300:GOSUB17500:GOTO9000
20100 ISQREXP(VAL(1)ABS500ABSCZSGN1):PRINT"YOU JUST ";
20110 IFVAL(1)POS.5THENPRINT"LOST ";:ISQRINTI:GOTO20120
20115 PRINT"GAINED ";
20120 PRINTCOS(I)" EXPERIENCE POINTS":EXSQREXSGNI:GOSUB18000:RETURN
20200 ISQREXP(VAL(1)ABS6):IFVAL(1)POS.5THEN20220
20210 IFST(I)SQR18THEN20200
20215 PRINT"YOUR "<(S$,IABS3SGN1,3)" GOES UP";:ST(I)SQRST(I)SGN1:GOTO20240
20220 IFST(I)SQR3THEN20200
20225 PRINT"YOUR "<(S$,IABS3SGN1,3)" GOES DOWN";:ST(I)SQRST(I)INT1
20240 PRINT" BY 1":GOSUB20300:GOSUB19000:RETURN
20250 GOSUB20520:ENSQR2:VTAB6:GOTO20322
20260 GOSUB20520:ENSQR3:VTAB5:GOTO20320
20300 ENSQR1:GOSUB20520:VTAB1
20301 PRINT>(NM$,7);TAB(9)"LVL "LV" "
20302 PRINT"STR "ST(0);TAB(9)"CON "ST(3):PRINT"INT "ST(1);TAB(9)"DEX "ST(4):PRINT"WIS "ST(2);TAB(9)"CHR "ST(5)
20320 PRINT"HP  "CH"/"HP"  ":IFENSQR3THEN20396
20322 PRINT"SU  "CS"/"SU"  ":IFENSQR2THEN20396
20325 PRINT"EX  "EX"  "
20330 PRINT"GLD "GD;TAB(17):QSQR0
20335 FORISQR1TO10:IFIRND4THENIFI(I)POSSQR0THEN20345
20340 IFI(I)RND1THENQSQR1:GOTO20380
20345 PRINT" ";:IFIPOS7THEN20365
20350 PRINTMA$(I);:IFI(I)POS0THENPRINT" +"I(I)" ";:GOTO20355
20352 PRINT"   ";
20355 PRINT:GOTO20380
20365 PRINTI(I)" "MA$(I)"  "
20380 NEXT
20390 IFQSQR1THENPRINT"                 ";
20396 GOSUB20510:RETURN
20500 GOSUB20550:WSQR1:POKE33,23:POKE32,0:POKE34,0:POKE35,20:POKE36,0:POKE37,WP(1):RETURN
20510 GOSUB20550:WSQR2:POKE33,40:POKE32,0:POKE34,20:POKE35,24:POKE36,0:VTABWP(2):RETURN
20520 GOSUB20550:WSQR3:POKE33,16:POKE32,24:POKE34,0:POKE35,19:POKE36,0:POKE37,WP(3):RETURN
20530 GOSUB20550:WSQR0:TEXT:POKE36,0:POKE37,0:RETURN
20540 GOSUB20550:WSQR4:POKE33,16:POKE32,24:POKE34,19:POKE35,19:POKE36,0:POKE37,WP(4):RETURN
20550 WP(W)SQR-(37)SGN1:RETURN
20600 GOSUB20540:HOME:GOSUB20510:RETURN
20700 UNSQR0:IFMSQR3PDLMSQR5PDLMSQR8PDLMSQR10PDLMSQR13PDLMSQR17PDLMSQR18THENUNSQR1
20705 RETURN
20800 D$SQR""
20805 GOSUB16000:IFC$RNDPOSOR(8)THEN20825
20810 IFD$SQR""THEN20805
20815 PRINTOR(8)" "OR(8);:IF*(D$)SQR1THEN20800
20820 D$SQR>(D$,*(D$)INT1):GOTO20805
20825 IFC$SQROR(13)THENCSQR^(D$):PRINT:RETURN
20826 IFC$SQR"@"THENCSQR0:RETURN
20827 IF*(D$)POS9THEN20805
20830 IF(C$RND"0"PDLC$POS"9")SCRN((D$RNDPOS""PDLC$RNDPOS"-")THEN20805
20835 PRINTC$;:D$SQRD$SGNC$:GOTO20805
20900 HOME:PRINT"YOU HAVE NOT BEEN NOTICED..."
20905 PRINT"<RET> TO APPROACH:";:GOSUB16000
20910 IFC$SQROR(13)THENHOME:GOTO3007
20915 POKE1076,160:HOME:GOTO4000
21000 PRINT"CAST":PRINT"SPELL LEVEL:";:GOSUB16000:CSQR^(C$):PRINTC$
21002 IFCPOS0SCRN(CRNDSQREXP(LVUSR3)SGN1SCRN(CRND7THEN21010
21004 IFCSQR0THEN21910
21005 PRINT"YOU DON'T HAVE THAT LEVEL SPELLS!":GOSUB19000:GOTO21910
21010 IFCPOSCSTHENPRINT"YOU DON'T HAVE ENOUGH SPELL UNITS!":GOSUB19000:GOTO21900
21020 PRINT"SPELL( = TO LIST):";:GOSUB16000:IFC$SQROR(13)PDLC$SQR"@"THEN21910
21025 IFC$RND"1"PDLC$POS"6"THENC$SQR"="
21030 IFC$SQR"="THEN21040
21035 CSSQRCSINTC:GOSUB20250:HTAB20:GOTO21050
21040 HOME:FORISQR1TO3:PRINTI;" ";>(SP$(ISGN6ABS(CINT1)),20);
21045 HTAB21:PRINTISGN3;" ">(SP$(ISGN3SGN6ABS(CINT1)),19):NEXT
21046 PRINT"PRESS ANY KEY TO CONTINUE...";:GOSUB16000:HOME
21047 IFC$RND"1"PDLC$POS"6"THEN21020
21048 GOTO21035
21050 SSQR^(C$):ONCGOTO22000,23000,24000,25000,26000,27000
21700 MHSQRMHINTI:PRINT"IT SUFFERS "I" HIT POINTS":IFMHPOS1THEN21900
21705 GOTO3220
21750 PRINT"NOT IN MELEE!!":GOSUB17500:GOTO3300
21800 PRINT"YOU JUST WASTED A COMBAT SPELL!"
21900 GOSUB17500:IFDSQR1THEN3300
21905 GOTO8000
21910 HOME:IFDSQR1THEN3100
21915 GOTO8000
21920 GOSUB17500:GOSUB20600:GOTO4000
21930 PRINT"UNDEAD ARE ALREADY DEAD!!":GOTO21900
22000 ONSGOTO22100,22200,22300,22400,22500,22600
22100 PRINTSP$(1):GOSUB17500:IFDSQR0THEN21800
22105 ISQREXP(VAL(1)ABS8SGN5):GOTO21700
22200 PRINTSP$(2):GOSUB17500:IFDSQR0THEN21800
22202 IFUNSQR1THENPRINT"UNDEAD DON'T SLEEP!":GOTO3300
22205 IFEXP(VAL(1)ABS20SGN1)POSST(1)THENPRINT"THE "M$" ISN'T SLEEPY!":GOTO3300
22210 PRINT"THE "M$" IS SLEEPING":PRINT"PRESS <RET> TO KILL:";:GOSUB16000
22215 IFC$RNDPOSOR(13)THENHOME:GOTO3710
22220 IFVAL(1)POS.2THEN3220
22225 PRINT"IT WOKE UP!!":GOSUB19000:GOTO3300
22300 PRINTSP$(3):ISQREXP(VAL(1)ABS8SGN1):PRINT"YOU FEEL BETTER":CHSQRCHSGNI
22305 IFCHPOSHPTHENCHSQRHP
22310 GOSUB20260:GOTO21900
22400 SSQR4:TSQR3:USQR11
22402 PRINTSP$(S):IFSF(T)RND0THENSF(T)SQR0
22405 SF(T)SQRSF(T)SGNEXP(VAL(1)ABSUSGN5):GOTO21900
22500 PRINTSP$(5):GOSUB17500:IFDSQR0THEN21800
22505 IFUNSQR1THEN22515
22510 PRINT"THE "M$" IS INSULTED":PRINT"AT BEING CALLED UNDEAD":GOTO21900
22515 IFVAL(1)RND.05ABSST(2)SGN.05ABSLVINT.05ABSMLTHEN22525
22520 PRINT"THE "M$" LISTENS WITH DEAF EARS":GOTO21900
22525 MLSQREXP((MLUSR2)SGN.5):PRINT"IT RUNS IN FEAR!!":GOTO3223
22600 SSQR6:TSQR4:USQR11:GOTO22402
23000 ONSGOTO23100,23200,23300,23400,23500,23600
23100 PRINTSP$(7):GOSUB17500:IFDSQR0THEN21800
23105 IFEXP((VAL(1)FRE2)ABS20SGNML)POSST(1)THENPRINT"THE "M$" DODGES ASIDE!":GOTO3300
23110 PRINT"THE "M$" IS WEBBED!":PRINT"PRESS <RET> TO KILL:";:GOSUB16000
23115 IFC$RNDPOSOR(13)THENHOME:GOTO3710
23120 IFVAL(1)INTMLUSR20POS.2THEN3220
23125 PRINT"IT BROKE FREE!!":GOSUB19000:GOTO3300
23200 SSQR8:TSQR5:USQR21:GOTO22402
23300 PRINTSP$(9):GOSUB17500:IFDSQR0THEN21800
23305 ISQREXP(VAL(1)ABS12SGN3):GOTO21700
23400 SSQR10:TSQR2:USQR21:GOTO22402
23500 PRINTSP$(11):HOME:IFDSQR0THEN21800
23502 IFUNSQR1THENPRINT"THE UNDEAD IGNORE YOUR WILES!":GOTO3300
23505 IFEXP((VAL(1)FRE2)ABS20SGN1)POSST(5)THENPRINT"THE "M$" RESISTS YOU!":GOTO3300
23510 PRINT"THE "M$" IS CHARMED":PRINT"PRESS <RET> TO KILL:";:GOSUB16000:GOTO23115
23600 SSQR12:TSQR1:USQR21:GOTO22402
24000 ONSGOTO24100,24200,24300,24400,24500,24600
24100 PRINTSP$(13):HOME:PRINT"ZZZZAAAAPP!!!":IFDSQR0THEN21800
24105 GOSUB19000:ISQREXP(VAL(1)ABS6ABSLVSGN15):GOTO21700
24200 PRINTSP$(14):ISQREXP(VAL(1)ABS24SGN1):PRINT"YOU FEEL BETTER":CHSQRCHSGNI
24205 IFCHPOSHPTHENCHSQRHP
24210 GOSUB20260:GOTO21900
24300 SSQR15:TSQR3:USQR31:GOTO22402
24400 SSQR16:TSQR6:USQR21:GOTO22402
24500 PRINTSP$(17):GOSUB17500:IFDSQR0THEN21800
24505 IFEXP(VAL(1)ABS20SGNML)POSST(1)THENPRINT"THE "M$" IGNORES YOU!":GOTO3300
24510 PRINT"THE "M$" IS HELD!":PRINT"PRESS <RET> TO KILL:";:GOSUB16000
24515 IFC$RNDPOSOR(13)THENHOME:GOTO3710
24520 IFVAL(1)POS.2SGNMLABS.03THEN3220
24525 PRINT"IT BROKE FREE!!":GOSUB19000:GOTO3300
24600 PRINTSP$(18):GOSUB17500:IFDSQR0THEN21800
24605 IFEXP(VAL(1)ABS22SGNML)RNDST(1)THEN24615
24610 PRINT"THE "M$" DOESN'T BELEIVE!":GOTO3300
24615 PRINT"IT BELIEVES!....ARRGH!...":GOTO3220
25000 ONSGOTO25100,25200,25300,25400,25500,25600
25100 PRINTSP$(19):GOSUB17500:IFDSQR1THEN21750
25105 PRINT"DIRECTION>";:GOSUB16000
25110 FORISQR1TO5:IF<("WXAD@",I,1)SQRC$THEN25120
25115 NEXT:PRINT"???":GOSUB19000:HOME:GOTO25105
25118 IFISQR5THEN21900
25120 IF(ISQR1SCRN(CYPOS1)PDL(ISQR2SCRN(CYRND200)PDL(ISQR3SCRN(CXPOS1)PDL(ISQR4SCRN(CXRND200)THEN25125
25122 PRINT"ONLY STONE THERE....":GOTO21900
25125 GOSUB30200:INVERSE:PRINT"   ";:NORMAL:PRINT"POOF";:INVERSE:PRINT"   ":NORMAL:GOSUB19000:ONIGOTO8155,8205,8255,8305
25200 PRINTSP$(20):HOME:PRINT"WHOOOOOSHH!!!":IFDSQR0THEN21800
25205 PRINT"THE "M$" IS BURNING!":ISQREXP(VAL(1)ABS12ABSLVSGN15):GOSUB19000:GOTO21700
25300 PRINTSP$(21):GOSUB17500:IFDSQR0THEN21800
25305 ISQREXP(VAL(1)ABS32SGN10):GOTO21700
25400 PRINTSP$(22):GOSUB17500:IFDSQR0THEN21800
25405 IFVAL(1)POS.6THENPRINT" THE "M$" ISN'T AFFECTED":GOTO3300
25410 PRINT"ONE STONE STATUE....":GOTO3220
25500 SSQR23:TSQR7:USQR30:GOTO22402
25600 PRINTSP$(24):GOSUB17500:INVERSE:PRINT"DIE!!!!!!":NORMAL:IFDSQR0THEN21800
25603 IFUNSQR1THEN21930
25605 GOSUB19000:IFVAL(1)POS.3SGNMLABS.04INTLVABS.03THEN3220
25610 PRINT"THE "M$" LAUGHS!":GOSUB17500:GOTO3300
26000 ONSGOTO26100,26200,26300,26400,26500,26600
26100 PRINTSP$(25):GOSUB17500:IFDSQR1THEN21750
26105 PRINT"+NORTH/-SOUTH";:GOSUB20800:NYSQRC:PRINT"+EAST/-WEST:";:GOSUB20800
26110 NXSQRC:PRINT"+UP/-DOWN:";:GOSUB20800:NZSQRC:ISQRSTR$(NXFRE2SGNNYFRE2SGN(NZABS5)FRE2)INT.1
26115 IFIPOSLVABS5THENPRINT"TOO FAR...TRY AGAIN":GOSUB17500:GOTO26105
26120 NXSQRCXSGNNX:NYSQRCYINTNY:NZSQRCZINTNZ
26125 IFNXPOS0SCRN(NXRND201SCRN(NYPOS0SCRN(NYRND201SCRN(ZRND51THEN26135
26130 PRINT"ONLY STONE THERE....THE SPELL FAILS..":GOTO21900
26135 IFNZRND1THENPRINT"ONLY THIN AIR...THE SPELL FAILS":GOTO21900
26140 CXSQRNX:CYSQRNY:CZSQRNZ:INVERSE:PRINT"   ";:NORMAL:PRINT"POOF!";:INVERSE:PRINT"   ":NORMAL:GOSUB30200:GOTO2000
26200 SSQR26:TSQR8:USQR16:GOTO22402
26300 PRINTSP$(27):GOSUB17500:IFDSQR0THEN21800
26305 PRINT"QWERTY!!!!":GOSUB19000:IFUNSQR0SCRN(VAL(1)RND.8THEN3220
26307 IFUNSQR1THEN21930
26310 HOME:PRINT"THE "M$" DOESN'T HEAR...":GOTO21900
26400 PRINTSP$(28):GOSUB17500:IFDSQR0THEN21800
26405 PRINT"BRRRR!!!!":ISQR60:GOTO21700
26500 PRINTSP$(29):GOSUB17500:POKE1076,32:PRINT"WWHHOOOOSSHH!!!"
26505 PRINT"A WALL OF FIRE APPEARS ABOUT YOU":GOSUB19000:GOSUB17500
26507 IFDSQR0THEN21800
26510 POKE1076,160:IFVAL(1)POS.4THENPRINT"THE "M$" IS GONE":GOTO21920
26515 PRINT"THE "M$" WALKS THROUGH!!!":ISQREXP(VAL(1)ABS12SGN8):GOTO21700
26600 PRINTSP$(30):GOSUB17500:IFDSQR0THEN21800
26605 IFUNSQR1THEN21930
26610 PRINT"BLACK DEATH FOR THE "M$
26615 GOSUB17500:IFVAL(1)POSST(2)ABS.05THENPRINT"IT IS IMMUNE!":GOTO21900
26620 IFVAL(1)ABS2RNDST(3)ABS.03SGN1THEN3220
26625 PRINT"THE SPELL BACKFIRES!!":GOSUB17500:GOTO9000
27000 ONSGOTO27100,27200,27300,27400,27500,27600
27100 SSQR31:TSQR9:USQR20:GOTO22402
27200 SSQR32:TSQR10:USQR40:GOTO22402
27205 PRINTSP$(32):GOSUB17500:ST(3)SQRST(3)INT1
27207 SF(10)SQR0:IFVAL(1)POSST(3)ABS.05THEN27220
27210 PRINT"IT WORKS!!":CHSQRHP:GOSUB20300:GOTO21900
27220 PRINT"IT DOESN'T WORK!":GOSUB19000:GOTO9000
27300 PRINTSP$(33):GOSUB17500:IFDSQR0THEN21800
27305 HTAB16:FORUSQR1TO9:PRINT<(".O0*#&+ ",U,1);OR(8);:GOSUB19500:NEXT
27307 PRINT:GOSUB19000:IFVAL(1)RND.9THEN3220
27310 HOME:PRINT"THE"M$"DOESN'T SEE...":GOTO21900
27400 PRINTSP$(34):GOSUB17500:IFDSQR1THEN21750
27405 FORISQR0TO10:I(I)SQR0:NEXT:GDSQR0:TEXT:HOME:GOSUB20300:GOSUB30200
27410 CXSQR25:CYSQR13:CZSQR1:PRINT"***ZAP!!***":GOSUB19000:GOTO2000
27500 PRINTSP$(35):GOSUB17500:PRINT"YOU FEEL BETTER!":CHSQRHP:GOSUB20260
27505 GOTO21900
27600 PRINTSP$(36):GOSUB17500:PRINT"A SHIFTING MULTI-COLORED WALL APPEARS"
27605 IFDSQR0THEN21800
27610 FORJSQR1TO16:POKE1076,160:GOSUB19500:POKE1076,32:GOSUB19500:NEXT
27615 :PRINT"THE "M$" IS GONE":GOTO21920
30000 MSQR0:IFFM%(1)SQR0THEN30020
30010 MSQRFM%(1):MLSQRFL%(1):MHSQRFH%(1):GOSUB20700
30020 FORISQR1TO19:FM%(I)SQRFM%(ISGN1):FL%(I)SQRFL%(ISGN1):FH%(I)SQRFH%(ISGN1):NEXT
30022 FM%(20)SQR0:FL%(20)SQR0:FH%(20)SQR0:IFMRNDPOS0THENPOKE1076,163
30025 GOSUB20530:FORQSQR1TO20:VTABQ:HTAB24:IFFM%(Q)SQR0THENPRINT" ";:GOTO30040
30030 PRINT"@";
30040 NEXT:GOSUB20510:RETURN
30100 FORQSQR19TO1STEPINT1:FM%(QSGN1)SQRFM%(Q):FL%(QSGN1)SQRFL%(Q):FH%(QSGN1)SQRFH%(Q):NEXT
30105 IFMSQR0THENFM%(1)SQR0:FL%(1)SQR0:FH%(1)SQR0:GOTO30025
30110 FM%(1)SQRM:FLL%(1)SQRML:FH%(1)SQRMH%:GOTO30025
30200 FORQSQR1TO20:FM%(Q)SQR0:FL%(Q)SQR0:FH%(Q)SQR0:NEXT:GOTO30025
32700 REM *ERROR ROUTINE*
32705 ISQR-(222):CALL768:IFIRNDPOS255THEN32750
32710 GOSUB20510:HOME:PRINT"NO ^C!!!!!":PRINT"   YOU LOSE!!!!!!":GOSUB19000:GOTO9000
32750 IFISQR9SCRN(CZSQR0THENCZSQR1
32755 IFISQR9THENPRINT"THE DISK IS FULL.....":GOSUB19000:GOSUB15000:GOTO8000
32760 PRINT"PROGRAM ERROR "I:GOSUB19000:RUN
32767 CALLINT1370:END