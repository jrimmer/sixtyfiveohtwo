2077 

9286 =",V254,S6,D1":ONERRGOTO10
20 PRINT:PRINTCHR$(4)"MAXFILES 2":PRINTCHR$(4)"BLOAD CHAIN,A520"F$
30 POKE51,0:CALL1002:PRINT:PRINTCHR$(4)"BLOADDRIVER DATA"F$:PRINTCHR$(4)"BRUNDRIVER":PR#0:POKE56,102:POKE57,213:CALL1002
40 B=35840:POKE216,0:HIMEM:B
50 SP$="  ":FORX=1TO6:SP$=SP$+SP$:NEXTX:SP$=SP$+MID$(SP$,2):A=FRE(0):HIMEM:B-256
60 POKE970,32:POKE971,14:&G:POKE1,0:POKE2,0:POKE961,0:POKE960,0:POKE964,0
70 EL$=CHR$(13):SC$=CHR$(14)+CHR$(12):DL$=EL$+EL$:ML=30:DIMD$(ML+7):VW=39:D$=CHR$(4)
80 PRINTD$"OPENSETVALUES":PRINTD$"READSETVALUES"
90 INPUTI$,ML,I$,WN,I$,AN,I$,SN,I$,FL,I$,CN,I$,MS,I$,LN,I$,FO,I$,B$(8),I$,LJ,I$,B$(9),I$,GP$
100 PRINTD$"CLOSE"
110 DIMS$(SN),S(SN),U(SN),C$(29)
120 PRINTD$"OPENCONFIG"F$:PRINTD$"READCONFIG":FORX=1TO29:INPUTI$,V,S,D:C$(X)=",V"+STR$(V)+",S"+STR$(S)+",D"+STR$(D):NEXT
130 GOSUB150:MA$=A$:GOSUB150:BO$=A$:GOSUB150:ML$=A$:GOSUB150:CH$=A$:GOSUB150:FT$=A$:GOSUB150:OF$=A$:GOSUB150:GA$=A$:GOSUB150:ST$=A$:GOSUB150:AS$=A$:GOSUB150:AV$=A$:GOSUB150:JO$=A$:GOSUB150:CE$=A$
140 PRINTD$"CLOSE":GOTO160
150 INPUTA$,B$(1),B$(2),B$(3):A$=B$(1)+B$(2)+B$(3):RETURN
160 PRINTD$"OPENSPELLS,L40"C$(13):FORX=1TOSN:PRINTD$"READSPELLS,R"X:INPUTS$(X),U(X),U(X):NEXT:PRINTD$"CLOSE"
170 PRINTD$"OPENMODULES"C$(8):PRINTD$"READMODULES":INPUTI$,CA$,I$,BD$,I$,SF$,I$,SY$,I$,CL$:PRINTD$"CLOSE"
180 IFBD$<>"Y"THEN220
190 PRINTD$"OPENBDATA"C$(2):PRINTD$"READBDATA":INPUTB1,X:PRINTD$"CLOSE"
200 DIMT$(X+1),N%(X+1),Z(B1)
210 MM=X
220 ONERRGOTO250
230 PRINTD$"OPENDATA"C$(5):PRINTD$"READDATA":INPUTMN,A,YR$,DA$,LA,LA$,NU,TM,ME$,IN:PRINTD$"CLOSE"
240 US=A:GOSUB8300:TI=0:GOTO260
250 CALL-3288:GOTO250
260 NORMAL:TEXT:HOME:HTAB(11):PRINT"Proving Grounds Status":VTAB(4):PRINT" Awaiting Caller: ["LA+1"]":PRINT"     Calls Today: ["LA-MN"]":PRINT"            Date: "DA$
270 PRINT"----------------------------------------"
280 &H:POKE960,0:VTAB6:CALL-958:PRINT:POKE-16368,0:O$=SC$:GOSUB7000:T0=0:GOSUB8300:T0=T:POKE0,VW:POKE1,0:POKE2,0
290 O$="Zap!":B$="Relax and Prepare yourself....":GOSUB8740:O$=O$+DL$+B$+DL$+"Your life is about to be changed in..."+DL$+"The Proving Grounds!"
300 ONERRGOTO8630
310 GOSUB7000
320 IFCA$<>"Y"THEN340
330 O$=DL$+"Are You using Cat-Fur? Y/N:":GOSUB6000:IFI$="Y"THENCF=1:CALL36798
340 YO$="You don't have that much!"
350 L$(1)="Low-Life Scum":A(1)=0:L$(2)="Maggot":A(2)=3000
360 O$=DL$+"Enter # or N/ew or M/atch-/>":GOSUB6000:IFI$<>"N"ANDI$<>"M"THEN870
370 IFI$<>"M"THEN420
380 O$=EL$+"Enter Match Name->":GOSUB6000:O$=I$:GOSUB8640:PRINTD$"OPENSTATS,L200"
390 FORX=1TOUS:PRINTD$"READSTATS,R"X:INPUTO$:IFO$=B$(0)THENPRINTD$"CLOSE":O$=EL$+B$(0)+" is User #"+STR$(X):GOSUB7000:GOTO360
400 NEXT
410 PRINTD$"CLOSE":O$=EL$+"Sorry, no Match.":GOSUB7000:GOTO360
420 F$="NEW":GOSUB8410:O$=DL$:GOSUB7000:F$="HELP":O$=EL$:GOSUB7000:GOSUB8420:O$=DL$:GOSUB7000:F$="FEES":GOSUB8420
430 O$=DL$+"New User System"+EL$+"---------------":GOSUB7000
440 POKE2,255
450 O$=DL$+"[> Enter FULL Name <]->":GOSUB6000:NA$=I$:O$=EL$+"[> Enter Your PSWD <]->":GOSUB6000:PA$=I$
460 O$=NA$:GOSUB8640:NA$=B$(0)
470 POKE2,0
480 O$=EL$+"[Hold...] Checking for same name"+DL$+"[":GOSUB7000
490 FORX=1TOSN:S(X)=0:NEXT
500 ST=10:AG=10:WI=10:CH=10:WE=2:AR=2:EX=0:GD=500:LE=1:FI$="On":AD$="NO":CP=2:FD=100:CA=0:CL=0:PO=20:TP=20:BA=100:HP=20:TH=20
510 PO=20:TP=20:BA=100:PA=-1:LS=0:DE=0
520 S(3)=1:S(6)=1:S(26)=2:S(10)=1:S(2)=2:S(8)=1
530 IFLEN(NA$)>20THENO$=EL$+"Your Name is To Long! Max=20 Characters":GOSUB7000:GOTO450
540 IFLEN(PA$)>7THENO$=EL$+"Your PSWD is to Long! Max=7 Characters":GOSUB7000:GOTO450
550 ONERRGOTO630
560 A=US:G(1)=-1
570 PRINTD$"OPENSTATS,L200"C$(15):FORX=1TOA:PRINTD$"READSTATS,R"X:INPUTO$:IFO$=NA$THENPRINTD$"CLOSE":O$="]"+EL$+EL$+"[That name is in Use!]":GOSUB7000:GOTO450
580 IFO$="Empty"ANDG(1)=-1THENB$(1)="EMPTY/USER":G(1)=X-1
590 O$=".":GOSUB7000
600 NEXTX
610 IFB$(1)="EMPTY/USER"THENA=G(1)
620 PRINTD$"CLOSE":GOTO640
630 CALL-3288:PRINTD$"CLOSE"
640 O$="]"+DL$+"Your Name is ["+NA$+"]"+EL$+"Your Pswd is ["+PA$+"]"+EL$+"User  Number ["+STR$(A+1)+"]"+DL$+"Ok? Y/N:":GOSUB6000
650 IFI$="N"THEN450
660 IFB$(1)<>"EMPTY/USER"THENUS=US+1
670 A=A+1:O$=EL$+"[Hold...]  Saving Stats"+EL$:GOSUB7000
680 ONERRGOTO750
690 PRINTD$"OPENTOP,L35"C$(16)
700 X=0
710 X=X+1
720 PRINTD$"READTOP,R"X
730 INPUTA$
740 GOTO710
750 CALL-3288
760 PRINTD$"OPENTOP,L35"C$(16)
770 PRINTD$"WRITETOP,R"X
780 PRINT"A":PRINTNA$" #"A:PRINTLE
790 PRINTD$"CLOSE"
800 PRINTD$"OPENRANK,L4"C$(11)
810 PRINTD$"WRITERANK,R"A
820 PRINTX
830 PRINTD$"CLOSE"
840 PRINTD$"OPENCASTLES,L39"C$(12):PRINTD$"WRITECASTLES,R"A:PRINT"00000000000000000000000000000000000000":PRINTD$"CLOSE"
850 B$(1)="Never"
860 X=-99:GOTO1010
870 A=VAL(I$)
880 IFA=0ORA>USTHEN360
890 PRINTD$"OPENSTATS,L200"C$(15)
900 ONERRGOTO1120
910 PRINTD$"READSTATS,R"A
920 INPUTNA$,FI$,LE,AG,WE,AR,EX,GD,ST,TH,HP,PA$,WI,CH,LS,CA,CL,AD$,CP,FD,PO,TP,BA,PA,DE,B$(1)
930 IFDA$<>B$(1)THENCA=0
940 IFST<0THENST=ST-(ST*2)
950 IFAG<0THENAG=AG-(AG*2)
960 IFNA$=SY$THEN980
970 IFCA>=CPTHENO$=EL$+"You are out of calls.  Later.":GOSUB7000:PRINTD$"CLOSE":RUN
980 FORX=1TOSN:INPUTS(X):NEXT
990 PRINTD$"CLOSE":GOTO1010
1000 CALL-3288
1010 TI=0:IFCL$="N"THENCO=20:GOTO1080
1020 GOSUB8300:PRINTD$"OPENTIMESLOTS"C$(21):PRINTD$"READTIMESLOTS":FORX=1TOY+1:INPUTA$,I$,CO:NEXT:PRINTD$"CLOSE"
1030 IF(AD$="Yes"ANDI$="Hlf Users")OR(AD$="NO"ANDI$="Val Users")THENO$="Half Validated users":GOTO1050
1040 GOTO1080
1050 IFI$="Val Users"THENO$="Validated users"
1060 O$=EL$+"Sorry, but the hour from "+A$+" is only for "+O$+".":GOSUB8550:GOSUB7000:RUN
1080 GOSUB8300
1090 PRINTD$"OPENLEVELS"C$(7):PRINTD$"READLEVELS"
1100 IFLE=1THEN1120
1110 FORX=1TOLE-1:INPUTL$(1),A(1):NEXT
1120 INPUTL$(1),A(1),L$(2),A(2)
1130 PRINTD$"CLOSE":Y=0
1140 IFB$(1)="Never"THEN1220
1150 O$=DL$+"Password-/>":GOSUB7000:POKE1,37:GOSUB8000:POKE1,0
1160 IFNA$="Empty"ANDI$=PA$THENO$=EL$+"Sorry, you were deleted.  Log on again."+EL$:GOSUB7000:GOTO420
1170 IFI$=PA$ORPEEK(966)=0THEN1220
1180 O$=EL$+"Invalid Password!":Y=Y+1:IFY=4THENO$=EL$+"Either you forgot your user password    or you were deleted.  Please log on new again."+DL$+"[Press Return]":CR=1:GOSUB6000:GOTO420
1190 GOSUB7000
1200 IFY=2THEN360
1210 GOTO1150
1220 O$=SC$:GOSUB7000:TEXT:HOME:PRINT"Name:["NA$"] Pass:["PA$"]":PRINT"Date:["T$"]":PRINT"Calls:["CA+1"] Level:["LE"] Caller:[#"LA-MN+1"]":PRINT:PRINT"----------------------------------------":POKE34,5
1230 POKE1190,171
1235 FO=4-FO:LJ=2-LJ:IFAD$="NO"THENFO=4-VAL(B$(8)):LJ=2-VAL(B$(9)):CO=CO-5
1240 O$=SC$+DL$+"    -=*> Opening The Gates For <*=-"+DL$:GOSUB7000
1250 A$=NA$:GOSUB8750:O$=O$+DL$+DL$:GOSUB7000:B(9)=21
1255 A$="-=*>Last Caller Was<*=-":GOSUB8750:O$=O$+DL$:GOSUB7000:A$=LA$:GOSUB8750:O$=O$+DL$:GOSUB7000
1260 O$="":FORX=1TOB(9):O$=O$+"-":NEXT:B$(9)=O$:O$=O$+EL$:A$="Date":B$=DA$:GOSUB8760:A$="Last":B$=B$(1):GOSUB8760:A$="Since":B$=STR$(LA-LS)+" Calls":GOSUB8760
1270 PRINT:PRINTD$"OPENRANK,L4"C$(11):PRINTD$"READRANK,R"A:INPUTG(1):PRINTD$"CLOSE":A$="Rank":B$=STR$(G(1)):GOSUB8760
1280 PRINTD$"OPENWEAPONS,L40"C$(19):PRINTD$"READWEAPONS,R"WE:INPUTWP$,HT,HT:PRINTD$"CLOSE"
1290 PRINTD$"OPENARMOR,L40"C$(1):PRINTD$"READARMOR,R"AR:INPUTAM$,AP,AP:PRINTD$"CLOSE"
1300 A$="Mail"
1310 ONERRGOTO1340
1320 PRINT
1330 PRINTD$"BLOADM-"NA$""C$(20)
1340 IFPEEK(222)=13THENCALL-3288:B$="Yes":MA=1:GOTO1360
1350 B$="None"
1360 GOSUB8760:LA=LA+1:LA$=NA$:ONERRGOTO1400
1370 IFBD$<>"Y"THEN1430
1380 PRINTD$"OPENQSCAN,L"(B1+1)*4""C$(10):PRINTD$"READQSCAN,R"A:INPUTMT:FORX=1TOB1:INPUTZ(X):NEXT:PRINTD$"CLOSE"
1390 GOTO1410
1400 CALL-3288:FORX=1TOB1:Z(X)=0:NEXT:MT=0
1410 A$="Msgs":X=TM-MT:IFX<0THENX=0
1420 B$=STR$(X)+" New":GOSUB8760
1430 CA=CA+1:A$="Calls":B$=STR$(CP-CA)+" Left":GOSUB8760
1440 O$=O$+B$(9)+DL$+"[Press Return]":CR=1:GOSUB6000:O$=DL$+"Events while gone:"+DL$:GOSUB7000:O$=""
1450 IFB$(1)="Never"THEN1510
1460 ONERRGOTO1500
1470 PRINTD$"OPENDOWNS,L17"C$(15):PRINTD$"READDOWNS,R"A:INPUTJW,JL,X,J,LR:PRINT@$"CLOSE"
1480 IFX>0ORJ>0THENO$=DL$+"Joust Victories: "+STR$(X)+EL$+"   Joust Losses: "+STR$(J)+EL$
1490 GOTO1510
1500 CALL-3288
1510 ONERRGOTO1600
1520 IFFI$<>"Dead"THEN1610
1530 PRINTD$"OPENDEATH,L50"C$(6):PRINTD$"READDEATH,R"A:INPUTX,I$,B$(0):PRINTD$"CLOSE":PRINTD$"OPENSTATS,L200"C$(15):PRINTD$"READSTATS,R"X:INPUTB$(1):PRINTD$"CLOSE"
1540 O$=O$+"      Killed By: "+B$(1)+EL$
1550 O$=O$+"     Armor Loss: ":IFLEFT$(I$,1)="1"THENO$=O$+"Yes"+EL$
1560 IFLEFT$(I$,1)<>"1"THENO$=O$+"No"+EL$
1570 O$=O$+"    Weapon Loss: ":IFRIGHT$(I$,1)="1"THENO$=O$+"Yes"+EL$
1580 IFRIGHT$(I$,1)<>"1"THENO$=O$+"No"+EL$
1590 O$=O$+EL$+B$(1)+" Says:"+DL$+B$(0)+EL$:GOSUB7000:GOTO1610
1600 CALL-3288
1610 O$=EL$:GOSUB7000:F$="D-"+NA$
1620 ONERRGOTO1640
1630 PRINT:PRINTD$"BLOAD"F$""C$(20)
1640 CALL-3288:IFPEEK(222)=13THENPOKE960,0:PRINTD$"OPEN"F$:PRINTD$"READ"F$:GOSUB8430:PRINTD$"DELETE"F$
1650 IFBA<0THENBA=BA-(BA*2):O$=EL$+"Your castle was robbed!  You lost half  of your gold!  You had better make bet- ter protection!":GOSUB7000
1660 CL=CL+1:LS=LA:FI$="On":TL=CO
1670 IFAD$="NO"THENO$=DL$+"You only have "+STR$(IN-CL)+" calls left till you are deleted from the board.":GOSUB8550:GOSUB7000
1680 F$="NEWS":O$=DL$:GOSUB7000:GOSUB8420
1690 CP$="N"
1700 O$=DL$+"[Hold..] Loading Main Dungeon"+EL$:GOSUB7000
1710 IFPA>0THENPA=PA-1
1720 IFCF=2THENCF=1
1730 IFMA=1THENCN$="E,R#"
1740 IFCL=1THENCN$="I have power!,Y,&,V#"
1750 A$=MA$:GOSUB8610:CALL35848"MAIN"
1760 RUN
1770 A$=CH$:GOSUB8610:CALL35848"CHAT"
6000 GOSUB7000:GOSUB8000:RETURN
7000 &B/O$:POKE960,0:RETURN
8000 CC=0:IFPEEK(1)=128ANDCF=1ANDCA$="Y"THENCA$="N":CALL38539:CF=9
8010 IFCF=9ANDPEEK(1)<>128THENCF=1:CA$="Y"
8020 IFCA$<>"Y"ORLEN(CN$)>1THEN8040
8030 IFCF=1THENCALL38539
8040 IFPEEK(1)=128THEN8140
8050 IFLEN(CN$)=0THEN8140
8060 FORT=1TOLEN(CN$)
8070 IFMID$(CN$,T,1)=","THENI$=MID$(CN$,1,T-1):CN$=RIGHT$(CN$,LEN(CN$)-T):GOTO8110
8080 IFMID$(CN$,T,1)="#"THENI$=MID$(CN$,1,T-1):CN$="":GOTO8110
8090 NEXT
8100 POKE960,0
8110 IFO$="STOP"THENO$="":GOTO8210
8120 IFLEN(I$)=0THEN8050
8130 O$=I$+EL$:GOSUB7000:GOTO8290
8140 POKE960,0:&A/SP$:I$=MID$(SP$,1):IFPEEK(961)THEN1770
8150 CN$=I$+"#":O$="STOP"
8160 IFLEFT$(I$,1)="#"THENI$="#":CN$=""
8170 POKE961,0:IFPEEK(960)=255THENCC=CC+1:IFCC>1ORI$="OFF"THENRUN
8180 IFPEEK(960)=255THEN8140
8190 IFPEEK(1)=128THENCN$="":GOTO8230
8200 IFLEN(CN$)>0THEN8060
8210 IFLEN(I$)<>1ANDRIGHT$(I$,1)=" "THENI$=LEFT$(I$,LEN(I$)-1):GOTO8210
8220 IFLEN(I$)<>1ANDLEFT$(I$,1)=" "THENI$=RIGHT$(I$,LEN(I$)-1):GOTO8220
8230 IFLEN(I$)=0ANDCR=1THENO$=EL$:GOSUB7000:GOTO8250
8240 IFLEN(I$)=0THEN8000
8250 IFCA$<>"Y"THEN8290
8260 IFCF=1THENCALL36798
8270 IFI$="202 ON"THENO$=EL$+"202 is now On.":GOSUB7000:CALL36798:CF=1
8280 IFI$="202 OFF"THENO$=EL$+"202 is now Off.":GOSUB7000:CALL38539:CF=0
8290 CR=0:RETURN
8300 IFCL$="N"THENT$=DA$:RETURN
8310 PR#4:IN#4
8320 INPUT"#";B(0),T,B(1),Y,T,B(2)
8330 INPUT"%";T$
8340 PR#0:POKE56,102:POKE57,213:CALL1002
8350 DA$=LEFT$(T$,10)
8360 IFRIGHT$(DA$,1)=" "THENDA$=LEFT$(DA$,LEN(DA$)-1):GOTO8360
8370 IFTI=0THENTI=T
8380 IFTI>TTHENT=TI+(60-TI)+T
8390 TL=CO-(T-TI)
8400 RETURN
8410 HOME:O$=SC$+DL$+DL$+DL$:GOSUB7000
8420 POKE960,0:PRINTD$"OPEN"F$""C$(17):PRINTCHR$(4)"READ"F$
8430 IFCF<>1THEN8500
8440 C=1
8450 &E/ZZ$:IFLEN(ZZ$)>0THENA$=ZZ$:IFASC(LEFT$(A$,1))=0THENC=-1:GOTO8480
8460 C=C+1:O$=EL$+ZZ$:GOSUB7000
8470 IFC<>16THEN8450
8480 O$=DL$+"CR) Continue or Q)uit:":CR=1:GOSUB6000:IFI$="Q"ORC=-1THEN8510
8490 GOTO8440
8500 &C
8510 PRINTD$"CLOSE":IFPEEK(960)=255THENRUN
8520 IFPEEK(960)=PEEK(970)THENPOKE960,3:O$=EL$:GOTO7000
8530 IFPEEK(960)=PEEK(971)THENPOKE960,2
8540 RETURN
8550 IFLEN(O$)<40ORLEN(O$)>79THENRETURN
8560 X=0
8570 IFMID$(O$,40-X,1)=" "THENB$(0)=LEFT$(O$,39-X):B$(0)=B$(0)+EL$+RIGHT$(O$,LEN(O$)-(40-X)):GOTO8590
8580 X=X+1:GOTO8570
8590 O$=B$(0)
8600 RETURN
8610 Y=VAL(MID$(A$,4,1)):POKE43626,Y:Y=VAL(RIGHT$(A$,1)):POKE43624,Y:Y=VAL(LEFT$(A$,3)):IFYR$="Y"THENPRINTD$"OPEN VC,V"Y
8615 IFTC$="Y"THENPOKE1014,10:POKE952,215:POKE953,251
8620 RETURN
8630 CALL-3288:GOTO360
8640 B$(0)="":J=0
8650 FORX=1TOLEN(O$)
8660 A$=MID$(O$,X,1)
8670 IFX=1THENT=ASC(A$):IFT>64ANDT<91THEN8710
8680 T=ASC(A$):IFT<65ORT>90THENJ=1:GOTO8710
8690 IFJ=1THENJ=0:GOTO8710
8700 T=T+32:A$=CHR$(T)
8710 B$(0)=B$(0)+A$
8720 NEXT
8730 RETURN
8740 A$="":FORX=1TOLEN(B$):I$=MID$(B$,X,1)+EL$:A$=A$+I$:NEXT:B$=A$:RETURN
8750 O$="":Y=(40-LEN(A$))/2:FORX=1TOY:O$=O$+" ":NEXT:O$=O$+A$:RETURN
8760 Y=LEN(A$):FORX=YTO5:A$=" "+A$:NEXT:A$="|"+A$:A$=A$+": "+B$
8770 Y=LEN(A$):FORX=YTOB(9)-2:A$=A$+" ":NEXT:A$=A$+"|":O$=O$+A$+EL$:RETURN