2088 
9283 ="Y"THENPOKE1014,0:POKE952,240:POKE953,253
10 CALL54915
20 IFA>0THEN40
30 PRINTCHR$(4)"SAVEMA,S3":PRINTCHR$(4)"RUNCHAT,S6"
40 ONERRGOTO70
50 K=5:IFFE=1THEND1$=SY$:FE=0:GOTO160
60 GOTO510
70 CALL-3288:GOTO510
80 A$=OF$:GOSUB8420:CALL35848"OFF"
90 A$=CH$:GOSUB8420:CALL35848"CHAT"
100 RETURN
110 O$=EL$+"Send a Scroll.  Press 'M' for Match     or enter User #":GOSUB6000
120 IFI$="Q"THEN520
130 IFI$="M"THEN610
140 X=VAL(I$):IFX<1ORX>USTHEN110
150 PRINTD$"OPENSTATS,L200"C$(15):PRINTD$"READSTATS,R"X:INPUTD1$:PRINTD$"CLOSE":O$=EL$+"Send Mail to "+D1$+"? ":GOSUB6000:IFI$<>"Y"ORD1$="Empty"THEN110
160 GOSUB7010:IFNOTXTHEN570
170 CR=0:D3$="Letter Has Been Mailed":GOSUB450:GOTO510
180 O$=EL$+"Read Your Scrolls"+DL$:GOSUB7000
190 IFMA<>1THENO$=DL$+"You Have No Scrolls!":GOSUB7000:GOTO510
200 F$="M-"+NA$
210 PRINTCHR$(4)"OPEN"F$C$(20)
220 PRINTCHR$(4)"READ"F$:&E/ZZ$:IFZZ$=CHR$(0)THEN440
230 O$=DL$:GOSUB7000:C=1:BB=1
240 D$(1)=MID$(ZZ$,1):IFLEFT$(ZZ$,1)=CHR$(1)THENO$=D$(1)+DL$:GOSUB7000:&E/ZZ$:D$(3)=MID$(ZZ$,2):C=3:D$(2)=""
250 D1$=D$(C):D$(C)="[Written By]=>"+D$(C):O$=D$(C)+EL$:GOSUB7000:C=C+1
260 &E/ZZ$:D$(C)=MID$(ZZ$,1):IFPEEK(960)=PEEK(970)THENBB=0
270 IFZZ$<>CHR$(31)THENC=C+1:IFBBTHENO$=EL$+D$(C-1):GOSUB7000
280 IFC=16ANDCF=1THENO$=EL$+"[Press Return]":CR=1:GOSUB6000
290 IFZZ$<>CHR$(31)THEN260
300 POKE960,0:O$=DL$:GOSUB7000
310 O$=EL$+"[A/uto-Reply-D/elete-R/e-read]->":GOSUB7000:GOSUB8330:O$=EL$:GOSUB7000
320 IFI$<>"A"THEN380
330 O$=EL$+"[Hold...]  Checking for mailbox"+EL$:GOSUB7000:PRINTD$"OPENSTATS,L200"C$(15)
340 FORZ=1TOUS:PRINTD$"READSTATS,R"Z:INPUTO$
350 IFO$=D1$THENPRINTD$"CLOSESTATS":GOTO420
360 NEXT
370 PRINTD$"CLOSESTATS":O$=EL$+"Sorry, that character is no longer on   this system."+EL$:GOSUB7000:GOTO310
380 IFI$="Q"ANDJ=1THEN440
390 IFI$<>"R"THEN220
400 O$=DL$:GOSUB7000:FORZ=1TOC-1:O$=D$(Z)+EL$:GOSUB7000:IFPEEK(960)=PEEK(970)THENZ=C
410 NEXTZ:POKE960,0:O$=DL$:GOSUB7000:GOTO310
420 GOSUB7010:IFNOTXTHEN220
430 CR=0:D3$="Mailed to ["+D1$+"]"+EL$:GOSUB450:GOTO220
440 PRINTCHR$(4)"CLOSE":MA=2:O$=EL$:GOTO7000
450 O$=EL$+"Mailing To: "+D1$+DL$:GOSUB7000:PRINTCHR$(4)"OPENM-"D1$""C$(20):PRINTCHR$(4)"APPENDM-"D1$:PRINTCHR$(4)"WRITEM-"D1$
460 IFCR=1THENPRINTCHR$(1)
470 B(0)=-99
480 PRINTNA$:GOSUB8340:PRINT"[Day Mailed]=>"T$" #"J:PRINT:FORZ=1TOX:PRINTD$(Z):NEXTZ:PRINTCHR$(31)
490 B(0)=0
500 PRINTCHR$(4)"CLOSEM-"D1$:O$=D3$:GOTO7000
510 GOTO520
520 GOSUB8340:O$=DL$+"Dungeon Script Office"+DL$+"[S/end-R/ead-Q/uit]->":GOSUB6000
530 IFI$="S"THEN110
540 IFI$="Q"THEN580
550 IFI$="R"THEN180
560 GOTO510
570 IFFE=1THENFE=0:GOTO510
580 O$=DL$+"Return to Main Dungeon? [Y/N]:":GOSUB6000:IFI$<>"Y"THEN510
590 A$=MA$:GOSUB8420:CALL35848"MAIN"
600 RETURN
610 O$=EL$+"Enter Users Full Name->":GOSUB6000
620 O$=I$:GOSUB8440:I$=B$(0)
630 PRINTD$"OPENSTATS,L200"C$(15)
640 FORX=1TOUS
650 PRINTD$"READSTATS,R"X
660 INPUTB$(0):IFB$(0)=I$THENO$=EL$+B$(0)+" is User #"+STR$(X)+EL$:D1$=B$(0):GOSUB7000:PRINTD$"CLOSE":GOTO150
670 NEXT
680 PRINTD$"CLOSE"
690 O$=EL$+"There is no such user!"+EL$:GOSUB7000:GOTO110
6000 GOSUB7000:GOSUB8000:RETURN
7000 &B/O$:POKE960,0:RETURN
7010 HOME:O$=SC$+EL$+"  ["+STR$(ML)+"] Lines - [/EX] Ends  [/S] Saves":GOSUB7000:O$=EL$+"[/UP] Redo last line  [/LN] Line Number"+DL$:GOSUB7000:X=1
7015 IFCA$<>"Y"THEN7030
7020 POKE36996,76:POKE36998,142
7030 CR=1:POKE1,128:GOSUB8000:D$(X)=I$:POKE1,0:IFPEEK(872)=1THENPOKE0,VW
7040 IFI$="/EX"ORI$="/ex"THEND$(X)="":GOTO7120
7050 IFI$="/UP"ORI$="/up"ANDX>1THENO$="[Retype the line]"+EL$:GOSUB7000:X=X-1:GOTO7030
7060 IFI$="/S"ORI$="/s"THEND$(X)="":I$="S":GOTO7160
7070 IFI$="/LN"ORI$="/ln"THENO$="[Line # "+STR$(X)+"]"+EL$:GOSUB7000:X=X-1
7080 IFX=ML-5THENO$="[5] More lines"+EL$:GOSUB7000
7090 POKE38689,0:IFPEEK(36712)=1THENPOKE0,VW
7100 X=X+1:IFX<=MLTHEN7030
7110 O$=EL$+"That's ["+STR$(ML)+"] lines"+EL$:GOSUB7000
7120 O$=EL$+"[Edit/S/?]->":GOSUB7000:GOSUB8330
7125 O$=EL$:GOSUB7000
7130 IFI$="?"THENO$=DL$+"S)ave"+EL$+"L)ist"+EL$+"N)ew"+EL$+"C)ontinue"+EL$+"F)ix"+EL$+"Q)uit"+EL$:GOSUB7000:GOTO7120
7140 IFI$="Q"THENGOSUB7360:X=0:POKE36996,169:POKE36998,32:O$=DL$+"[Message Aborted!]":GOTO7000
7150 IFI$="L"THENA$="":GOSUB7300:GOTO7120
7160 IFI$="S"ORI$="O"THENX=X-1:POKE36996,169:POKE36998,32:RETURN
7170 IFI$="N"THENGOSUB7360:O$=EL$:GOSUB7000:GOTO7010
7180 IFI$="F"THEN7210
7190 IFI$="C"THENA$="":Z=X-1:F=Z-3:F=F*(F>-1)+1:GOSUB7330:X=X-1:GOTO7100
7200 GOTO7120
7210 O$=EL$+"List Lines [Y/N]:":GOSUB7000:GOSUB8330
7220 IFI$="N"THEN7250
7230 IFI$="Y"THENA$="X":GOSUB7300:GOTO7250
7240 GOTO7210
7250 O$=DL$+"Edit Line [CR=Quit] #":GOSUB7000:CR=1:GOSUB8300
7260 IFI$=""THEN7120
7270 REM
7280 IFJ<1ORJ>=XTHENO$=EL$+"[Line Doesn't Exist!]"+EL$:GOSUB7000:GOTO7120
7290 A$="["+RIGHT$("0"+STR$(J)+"] ",4):O$=EL$+A$+D$(J)+EL$+A$:GOSUB7000:CR=1:POKE1,128:GOSUB8000:D$(J)=I$:POKE1,0:GOTO7210
7300 O$=DL$+"List from [CR=Lists all] #":GOSUB7000:CR=1:GOSUB8300:F=1:Z=X-1:IFI$=""THEN7320
7310 F=J:O$="       To [CR=To The End] #":GOSUB7000:CR=1:GOSUB8300:Z=J:IFI$=""THENZ=X-1
7320 IFF<1ORZ>=XTHENO$=EL$+"[Line # Doesn't Exist!]"+EL$:GOTO7000
7330 O$=EL$:GOSUB7000:IFX<2THENRETURN
7340 FORJ=FTOZ:IFA$>""THENA$="["+RIGHT$("0"+STR$(J),2)+"] "
7350 O$=A$+D$(J)+EL$:GOSUB7000:NEXTJ:RETURN
7360 IFX>1THENO$=EL$+"Verify? [Y/N]:":GOSUB7000:GOSUB8330:IFI$<>"Y"THENPOP:GOTO7120
7370 RETURN
8000 CC=0:IFPEEK(1)=128ANDCF=1ANDCA$="Y"THENCA$="N":CALL38539:CF=9
8010 IFCF=9ANDPEEK(1)<>128THENCF=1:CA$="Y"
8020 IFCA$<>"Y"ORLEN(CN$)>1THEN8040
8030 IFCF=1THENCALL38539
8040 IFPEEK(1)=128THEN8140
8050 IFLEN(CN$)=0THEN8140
8060 FORT=1TOLEN(CN$)
8070 IFMID$(CN$,T,1)=","THENI$=MID$(CN$,1,T-1):CN$=RIGHT$(CN$,LEN(CN$)-T):GOTO8110
8080 IFMID$(CN$,T,1)="#"THENI$=MID$(CN$,1,T-1):CN$="":GOTO8110
8090 NEXT
8100 POKE960,0
8110 IFO$="STOP"THENO$="":GOTO8210
8120 IFLEN(I$)=0THEN8050
8130 O$=I$+EL$:GOSUB7000:GOTO8290
8140 POKE960,0:&A/SP$:I$=MID$(SP$,1):IFPEEK(961)THEN90
8150 CN$=I$+"#":O$="STOP"
8160 IFLEFT$(I$,1)="#"THENI$="#":CN$=""
8170 POKE961,0:IFPEEK(960)=255THENCC=CC+1:IFCC>1ORI$="OFF"THEN80
8180 IFPEEK(960)=255THEN8140
8190 IFPEEK(1)=128THENCN$="":GOTO8230
8200 IFLEN(CN$)>0THEN8060
8210 IFLEN(I$)<>1ANDRIGHT$(I$,1)=" "THENI$=LEFT$(I$,LEN(I$)-1):GOTO8210
8220 IFLEN(I$)<>1ANDLEFT$(I$,1)=" "THENI$=RIGHT$(I$,LEN(I$)-1):GOTO8220
8230 IFLEN(I$)=0ANDCR=1THENO$=EL$:GOSUB7000:GOTO8250
8240 IFLEN(I$)=0THEN8000
8250 IFCA$<>"Y"THEN8290
8260 IFCF=1THENCALL36798
8270 IFI$="202 ON"THENO$=EL$+"202 is now On.":GOSUB7000:CALL36798:CF=1
8280 IFI$="202 OFF"THENO$=EL$+"202 is now Off.":GOSUB7000:CALL38539:CF=0
8290 CR=0:RETURN
8300 GOSUB8000:IFI$=""THENRETURN
8310 J=INT(VAL(I$)):IFJ<0THENJ=0
8320 RETURN
8330 GOTO8000
8340 IFCL$="N"THENT$=DA$:RETURN
8350 PR#4:IN#4:INPUT"#";T,T,T,T,T,B:INPUT"%";T$
8360 PR#0:POKE56,102:POKE57,213:CALL1002
8370 IFTI>TTHENT=TI+(60-TI)+T
8380 TL=CO-(T-TI)
8390 IFB(0)=-99THEN8410
8400 IFTL<=0THENO$=EL$+"You are out of Time!  Later.":GOSUB7000:GOTO80
8410 RETURN
8420 Y=VAL(MID$(A$,4,1)):POKE43626,Y:Y=VAL(RIGHT$(A$,1)):POKE43624,Y:Y=VAL(LEFT$(A$,3)):IFYR$="Y"THENPRINTD$"OPEN VC,V"Y
8425 IFTC$="Y"THENPOKE1014,10:POKE952,215:POKE953,251
8430 RETURN
8440 B$(0)=""
8450 FORX=1TOLEN(O$)
8460 A$=MID$(O$,X,1)
8470 IFX=1THEN8510
8480 T=ASC(A$):IFT<65ORT>90THENJ=1:GOTO8510
8490 IFJ=1THENJ=0:GOTO8510
8500 T=T+32:A$=CHR$(T)
8510 B$(0)=B$(0)+A$
8520 NEXT
8530 RETURN