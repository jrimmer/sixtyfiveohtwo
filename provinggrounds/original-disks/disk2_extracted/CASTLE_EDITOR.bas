2088 
9283 ="Y"THENPOKE1014,0:POKE952,240:POKE953,253
10 CALL54915:Y=0
20 IFA>0THEN40
30 PRINTCHR$(4)"SAVECASTLE EDITOR,S3":PRINTCHR$(4)"RUNGA,S6"
40 L=1
50 IFLE>1THENL=2
60 IFLE>5THENL=3
70 IFLE>10THENL=4
80 IFLE>17THENL=5
90 IFLE>25THENL=6
100 IFLE>45THENL=7
110 IFLE>65THENL=8
120 IFLE>85THENL=9
130 IFLE>95THENL=10
140 ONERRGOTO170
150 PRINTD$"OPENCASTLES,L39"C$(12):PRINTD$"READCASTLES,R"A:INPUTCS$:PRINTD$"CLOSE"
160 GOTO180
170 CALL-3288:CS$="00000000000000000000000000000000000000"
180 FORX=1TO38STEP2
190 Y=Y+1
200 D$(Y)=MID$(CS$,X,2)
210 NEXT
220 GOSUB8460
230 HOME
240 ONERRGOTO260
250 GOTO270
260 CALL-3288:GOTO230
270 O$=SC$+DL$+"           -=>Castle Editor<=-"+DL$+"1. Edit Castle"+EL$+"2. Pay Rent/Fees"+EL$+"3. Castle Description/Help File"+DL$+"[You owe $"+STR$(R)+"][Cmd]->"
280 GOSUB6000
290 IFI$="Q"THEN8320
300 IFI$="3"THENF$="CASTLE.DES":O$=SC$:GOSUB7000:HOME:GOSUB8590:O$=EL$+"[Press Return]":CR=1:GOSUB6000
310 IFI$="1"THEN370
320 IFI$<>"2"THEN230
330 GOSUB8460
340 IFGD<RTHENO$=EL$+"You don't have enought gold!"+DL$+"[Press Return]":CR=1:GOSUB6000:GOTO230
350 UU=UU+R
360 GD=GD-R:O$=EL$+"Your payment has been registerd.":GOSUB7000:GOSUB8460:GOTO230
370 HOME:T=0
380 O$=SC$+"Room # / Monster / Trap"+DL$:GOSUB7000
390 FORX=1TO19
400 T=T+1
410 O$=STR$(X)+"] "
420 A$=LEFT$(D$(T),1)
430 B$=RIGHT$(D$(T),1)
440 IFA$="0"THENO$=O$+" - ":GOTO470
450 Y=ASC(A$)-64
460 O$=O$+"Lev. "+STR$(Y)+" Mon. -"
470 IFB$="0"THEN500
480 Y=ASC(B$)-64
490 O$=O$+" "+S$(Y)
500 O$=O$+EL$:GOSUB7000
510 NEXT
520 O$=EL$+"Edit Which(1-19)->":GOSUB6000
530 IFI$="Q"THENCP$="N":GOSUB8410:GOSUB8460:GOTO230
540 B(1)=VAL(I$):IFB(1)<1ORB(1)>19THEN520
550 O$=EL$+"Monster in the Room? Y/N->":GOSUB6000:IFI$="N"THENA$="0":GOTO660
560 HOME:O$=SC$+"Edit room #"+STR$(B(1))+DL$+"Which Monster: "+DL$+"0] No monster in Room"+EL$:GOSUB7000
570 O$="1-"+STR$(L)+"] Level Monsters"+EL$:GOSUB7000
580 O$=EL$+"Which(?=Menu)->":GOSUB6000:X=VAL(I$):IFI$="?"THEN560
590 IFI$="Q"THEN370
600 IFX<0ORX>LTHEN580
610 IFX=0THENA$="0":GOTO660
620 B(2)=X*X*X*100:O$=EL$+"A Level "+STR$(X)+" Monster's"+EL$+"Rent per call is $"+STR$(B(2))+EL$+"Rent monster? Y/N->":GOSUB6000:IFI$<>"Y"THEN580
630 A$=LEFT$(D$(B(1)),1):B$=RIGHT$(D$(B(1)),1)
640 Y=64+X
650 A$=CHR$(Y)
660 O$=EL$+"Spell Trap in the Room? Y/N->":GOSUB6000:IFI$="N"THENB$="0":GOTO820
670 HOME:O$=SC$+"Edit Room #"+STR$(B(1))+DL$+"Which Spell Trap:"+DL$+"0) No Spell"+EL$:GOSUB7000
680 FORX=1TO26
690 IFS$(X)="Death"ORS$(X)="Negate"THEN710
700 IFU(X)=0THEN720
710 O$=STR$(X)+") "+S$(X)+EL$:GOSUB7000
720 NEXT
730 O$=EL$+"Which(?=Menu)->":GOSUB6000
740 IFI$="Q"THEN370
750 IFI$="?"THEN660
760 IFI$="0"THENB$="0":GOTO820
770 X=VAL(I$):IFX<1ORX>26THEN730
780 IFU(X)=0ANDS$(X)<>"Death"ANDS$(X)<>"Negate"THEN730
790 Y=100*X*X
800 O$=EL$+"A "+S$(X)+" Spell Trap"+EL$+"Rent per call is $"+STR$(Y)+EL$+"Rent Trap? Y/N->":GOSUB6000:IFI$<>"Y"THEN730
810 Y=64+X:B$=CHR$(Y)
820 D$(B(1))=A$+B$:GOTO370
6000 GOSUB7000:GOSUB8000:RETURN
7000 &B/O$:POKE960,0:RETURN
8000 CC=0:IFPEEK(1)=128ANDCF=1ANDCA$="Y"THENCA$="N":CALL38539:CF=9
8010 IFCF=9ANDPEEK(1)<>128THENCF=1:CA$="Y"
8020 IFCA$<>"Y"ORLEN(CN$)>1THEN8040
8030 IFCF=1THENCALL38539
8040 IFPEEK(1)=128THEN8140
8050 IFLEN(CN$)=0THEN8140
8060 FORT=1TOLEN(CN$)
8070 IFMID$(CN$,T,1)=","THENI$=MID$(CN$,1,T-1):CN$=RIGHT$(CN$,LEN(CN$)-T):GOTO8110
8080 IFMID$(CN$,T,1)="#"THENI$=MID$(CN$,1,T-1):CN$="":GOTO8110
8090 NEXT
8100 POKE960,0
8110 IFO$="STOP"THENO$="":GOTO8210
8120 IFLEN(I$)=0THEN8050
8130 O$=I$+EL$:GOSUB7000:GOTO8290
8140 POKE960,0:&A/SP$:I$=MID$(SP$,1):IFPEEK(961)THEN8310
8150 CN$=I$+"#":O$="STOP"
8160 IFLEFT$(I$,1)="#"THENI$="#":CN$=""
8170 POKE961,0:IFPEEK(960)=255THENCC=CC+1:FORT=1TO500:NEXT:IFCC>1ORI$="OFF"THEN8300
8180 IFPEEK(960)=255THEN8140
8190 IFPEEK(1)=128THENCN$="":GOTO8230
8200 IFLEN(CN$)>0THEN8060
8210 IFLEN(I$)<>1ANDRIGHT$(I$,1)=" "THENI$=LEFT$(I$,LEN(I$)-1):GOTO8210
8220 IFLEN(I$)<>1ANDLEFT$(I$,1)=" "THENI$=RIGHT$(I$,LEN(I$)-1):GOTO8220
8230 IFLEN(I$)=0ANDCR=1THENO$=EL$:GOSUB7000:GOTO8250
8240 IFLEN(I$)=0THEN8000
8250 IFCA$<>"Y"THEN8290
8260 IFCF=1THENCALL36798
8270 IFI$="202 ON"THENO$=EL$+"202 is now On.":GOSUB7000:CALL36798:CF=1
8280 IFI$="202 OFF"THENO$=EL$+"202 is now Off.":GOSUB7000:CALL38539:CF=0
8290 CR=0:RETURN
8300 A$=OF$:GOSUB8390:CALL35848"OFF"
8310 A$=CH$:GOSUB8390:CALL35848"CHAT"
8320 A$=MA$:GOSUB8390:O$=EL$+"[Hold...] Transporting to Main"+EL$:GOSUB7000:CALL35848"MAIN"
8330 IFLEN(O$)<40ORLEN(O$)>79THENRETURN
8340 X=0
8350 IFMID$(O$,40-X,1)=" "THENB$(0)=LEFT$(O$,39-X):B$(0)=B$(0)+EL$+RIGHT$(O$,LEN(O$)-(40-X)):GOTO8370
8360 X=X+1:GOTO8350
8370 O$=B$(0)
8380 RETURN
8390 Y=VAL(MID$(A$,4,1)):POKE43626,Y:Y=VAL(RIGHT$(A$,1)):POKE43624,Y:Y=VAL(LEFT$(A$,3)):IFYR$="Y"THENPRINTD$"OPEN VC,V"Y
8395 IFTC$="Y"THENPOKE1014,10:POKE952,215:POKE953,251
8400 RETURN
8410 CS$=""
8420 FORX=1TO19
8430 CS$=CS$+D$(X)
8440 NEXT
8450 PRINTD$"OPENCASTLES,L39"C$(12):PRINTD$"WRITECASTLES,R"A:PRINTCS$:PRINTD$"CLOSE":RETURN
8460 R=0
8470 FORX=1TO19
8480 A$=LEFT$(D$(X),1)
8490 B$=RIGHT$(D$(X),1)
8500 IFA$="0"THEN8530
8510 Y=ASC(A$)-64
8520 R=R+(Y*Y*Y*100)
8530 IFB$="0"THEN8560
8540 Y=ASC(B$)-64
8550 R=R+(Y*Y*100)
8560 NEXT
8570 R=R-UU:IFR<1THENR=0:CP$="Y"
8580 RETURN
8590 POKE960,0:PRINTD$"OPEN"F$""C$(17):PRINTCHR$(4)"READ"F$
8600 IFCF<>1THEN8670
8610 C=1
8620 &E/ZZ$:IFLEN(ZZ$)>0THENA$=ZZ$:IFASC(LEFT$(A$,1))=0THENC=-1:GOTO8650
8630 C=C+1:O$=EL$+ZZ$:GOSUB7000
8640 IFC<>16THEN8620
8650 O$=DL$+"CR) Continue or Q)uit:":CR=1:GOSUB6000:IFI$="Q"ORC=-1THEN8680
8660 GOTO8610
8670 &C
8680 PRINTD$"CLOSE":IFPEEK(960)=255THEN8430
8690 IFPEEK(960)=PEEK(970)THENPOKE960,3:O$=EL$:GOTO7000
8700 IFPEEK(960)=PEEK(971)THENPOKE960,2
8710 RETURN