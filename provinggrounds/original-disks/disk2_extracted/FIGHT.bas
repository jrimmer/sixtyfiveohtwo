2088 
9283 ="Y"THENPOKE1014,0:POKE952,240:POKE953,253
10 AC$="":CALL54915:QA=0:AM=0:G(6)=0:K=0:B$="N":IFA>0THEN30
20 PRINTCHR$(4)"SAVEFIGHT,S3":PRINTCHR$(4)"RUNCASTLE EDITOR,S6"
30 T=WE:GOSUB40:B(1)=T:HT=B(4):GOTO220
40 PRINTD$"OPENWEAPONS,L40"C$(19):PRINTD$"READWEAPONS,R"T:INPUTB$(0),B(3),B(4):T=INT(B(3)/4):IFT>1000000THENT=1000000
50 PRINTD$"CLOSE":RETURN
60 PRINTD$"OPENARMOR,L40"C$(1):PRINTD$"READARMOR,R"T:INPUTB$(0),B(3),B(4):PRINTD$"CLOSE":RETURN
90 CALL-3288:GOTO230
100 IFFO>=4THEN130
110 O$=EL$+"Return To Main Dungeon? Y/N ":GOSUB6000
120 IFI$<>"Y"THEN230
130 O$=DL$+"-=> HOLD...Transport Heading to Main."+EL$:GOSUB7000
140 A$=MA$:GOSUB8850:CALL35848"MAIN"
150 PRINTD$"OPENSTATS,L200"C$(15)
160 PRINTD$"READSTATS,R"A
170 INPUTNA$,FI$,LE,AG,WE,AR,EX,GD,ST,TH,HP,PA$,WI,CH,LS,CA,CL,AD$,CP,FD,PO,TP,BA,PA,DE,I$
180 FORX=1TOSN:INPUTS(X):NEXT
190 PRINTD$"CLOSE"
200 IFI$="Q"THENPOP:GOTO230
210 RETURN
220 HOME:O$=SC$+DL$+DL$+EL$:GOSUB7000
230 GOSUB8300:O$=DL$+"Your choices are..."+DL$+"A) ttack a Users Castle"+EL$+"C) orridor Of Death"+EL$+"D) ungeon"+EL$+"P) roving Grounds"+DL$
240 O$=O$+"Which(FL="+STR$(4-FO)+"): ":GOSUB6000
245 ONERRGOTO90
250 IFI$="A"THEN9170
260 AC$="N":FI=0:B$(2)="":IFI$="C"THEN2490
300 IFI$="Q"THEN100
310 IFI$<>"D"ANDI$<>"P"THEN230
320 MO$="N":IFI$="D"THENMO$="Y":GOTO680
340 O$=EL$+"Enter user number of person you wish    to fight(1-"+STR$(US)+"/Q): #":GOSUB6000
350 X=VAL(I$)
360 GOSUB8300
370 IFA=XTHEN340
380 GOSUB200
390 ONERRGOTO500
400 PRINTD$"OPENSTATS,L200"C$(15)
410 PRINTD$"READSTATS,R"X
420 INPUTB$(1),B$(2),A1,A2,A3,A4,A5,A6,A7,A0,A9,A$,A8
430 S1=0:S2=0
440 PRINTD$"CLOSE"
450 IFA2<0THENA2=A2-(A2*2):Y=-99
460 IFA7<0THENGOSUB9380:A7=A7-(A7*2)
470 IFAC$="Y"THENGOSUB8870:RETURN
480 Y=0
490 GOTO510
500 CALL-3288:PRINTD$"CLOSE":O$=EL$+"There is no such user!"+EL$:GOSUB7000:GOTO340
510 IFLE>A1+FLTHENO$=EL$+"You can only fight a User higher or "+STR$(FL)+" levels below you."+EL$:GOSUB8420:GOSUB7000:GOTO340
520 ONERRGOTO550
530 IFB$(2)="Dead"THENPRINTD$"OPEN DEATH,L50"C$(6):PRINTD$"READ DEATH,R"X:INPUTI$:PRINTD$"CLOSE":O$=EL$+"Sorry, "+B$(1)+" has already been"+" killed by "+I$+"."+EL$:GOSUB8420:GOSUB7000:GOTO340
540 GOTO560
550 CALL-3288:O$=EL$+"Sorry, "+B$(1)+" is Dead."+EL$:GOSUB8420:GOSUB7000:GOTO340
560 IFB$(1)="Empty"THENO$=EL$+"Sorry, that Character has been deleted."+EL$:GOSUB7000:GOTO340
570 GOSUB8870
580 B$(3)=STR$(A3-WE):IFA3>WETHENB$(3)="+"+B$(3)
590 B$(4)=STR$(A4-AR):IFA4>ARTHENB$(4)="+"+B$(4)
600 B$(3)="  ("+B$(3)+")":B$(4)="  ("+B$(4)+")"
610 O$=EL$+"Character: "+B$(1)+DL$+"Weapon: "+MW$+B$(3)+EL$+" Armor: "+MH$+B$(4)+DL$+"Hit Points: "+STR$(A9)
620 GOSUB7000
630 O$=DL$+"Do you wish to fight "+B$(1)+"?"+EL$+"Y/N: ":GOSUB6000
640 GOSUB200
650 IFI$<>"Y"THEN340
660 FO=FO+1
670 FI=X
680 B$(3)="strike":B$(4)="hit":B$(5)="slam":B$(6)="rag":B$(7)="smite":B$(8)="pound"
690 IFMO$="R"THENRETURN
700 IFMO$="Y"THENGOTO1940
710 O$=DL$:GOSUB7000
720 IFAG>A2THENO$="You get first attack!"+DL$:GOSUB7000:GOTO1210
730 O$="He gets first attack!":GOSUB7000
740 O$=DL$:GOSUB7000
750 IFMO$="Y"THENX=INT(3*RND(1))+1:IFX=2THEN2390
760 IFA2>50THEN900
770 G(1)=A3+A2
780 G(2)=INT((WE+AG)*RND(1))+1
790 AM=INT((A7+A2+(2*MP))*RND(1))+1:IFAR>AMTHENO$="Your "+AM$+" Absorbes the Damage!":GOSUB8420:GOSUB7000:GOTO1210
800 IFG(2)<G(1)THEN900
810 X=INT(5*RND(1))+1
820 IFX=1THENO$=B$(1)+" swings at you with his "+MW$+" and misses!"
830 IFX=2THENO$="You duck skillfully under his blow!"
840 IFX=3THENO$="He swings at you but you jump nimbly aside!"
850 IFX=4THENO$=B$(1)+"s "+MW$+" flies over your head just missing you!"
860 IFX=5THENO$="His weapon misses you by a mile!"
870 GOSUB8420
880 GOSUB7000
890 GOTO1210
900 G(3)=(A7/25)+1
910 G(3)=G(3)*MP:G(8)=0
920 G(5)=G(3)*(AP*(1/100))
930 G(3)=G(3)-G(5)
940 G(4)=G(3)/4:G(3)=G(3)-(G(4)*RND(1))+G(4)
950 G(3)=INT(G(3))
960 X=INT(5*RND(1))+3
970 IFG(6)>0THENG(6)=G(6)-1:G(3)=INT(G(3)-(G(3)/3))
980 IFY=-99THENY=0:RETURN
990 IFG(8)=0THEN1010
1000 IFMO$="Y"THENO$=B$(1)+" casts a "+S$(G(8))+" spell which "+B$(X)+"s you doing "+STR$(G(3))+" damage.":GOSUB8420:GOSUB7000:GOTO1040
1010 O$=B$(1)+" "+B$(X)+"s you with his "+MW$+" doing "+STR$(G(3))+" damage."
1020 GOSUB8420
1030 GOSUB7000
1040 HP=HP-G(3):IFHP>0THEN1210
1050 O$=DL$+B$(1)+" has killed you!"+DL$+"He gets all your gold!"+EL$
1060 IFMO$="Y"THEN1110
1070 AM=0:QA=0
1080 IFWE>A3THENG(0)=A3:A3=WE:WE=G(0):O$=O$+DL$+"You Swap Weapons With Him!":AM=1
1090 IFAR>A4THENG(0)=A4:A4=AR:AR=G(0):O$=O$+DL$+"You Swap Armor With Him!":QA=1
1100 GOSUB7000:O$="":GOSUB8530
1110 A6=A6+GD:GD=0:A5=A5+EX:HP=TH:PO=TP:GOSUB7000
1120 IFB$<>"Y"THEN1190
1140 O$=EL$+"You have been Resurected!"+DL$+"Continue on Quest? Y/N ":GOSUB6000:IFI$<>"Y"ANDI$<>"N"THEN1140
1160 B$="N"
1170 IFI$="Y"THEN2870
1180 GOTO130
1190 IFMO$="Y"ORMO$="NV"THEN8370
1200 X=-99:GOTO1770
1210 IFMO$<>"Y"THEN1300
1220 IFFI>0THENO$=DL$+"F)ight, C)ast, H)ealth, S)tats: ":GOSUB6000:IFI$="C"THEN2130
1230 IFI$="S"THENGOSUB3210:GOTO1220
1240 IFFI>0ANDI$="H"THENGOSUB8660:GOTO1210
1250 IFFI>0ANDI$<>"F"THEN1210
1260 IFFI>0THEN1350
1270 O$=DL$+"F)ight, H)ealth, R)un, C)ast: ":GOSUB6000:IFI$="C"THEN2130
1280 IFI$="H"THENGOSUB8660:GOTO1270
1290 GOTO1330
1300 O$=DL$+"<F>ight <H>ealth <R>un: ":GOSUB6000
1310 IFI$="H"THENGOSUB8660:GOTO1300
1320 IFI$<>"F"ANDI$<>"R"ANDI$<>"Q"THEN1300
1330 IFI$="R"ORI$="Q"THEN100
1340 IFI$<>"F"THEN1270
1350 O$=EL$:GOSUB7000
1360 IFAG>50THEN1500
1370 G(1)=WE+AG
1380 G(2)=INT((A3+A2)*RND(1))+1
1390 AM=INT((ST+AG+(2*HT))*RND(1))+1:IFA4>AMTHENO$="His "+MH$+" Absorbes the Damage!":GOSUB8420:GOSUB7000:GOTO740
1400 IFG(1)>G(2)THEN1500
1410 X=INT(5*RND(1))+1
1420 IFX=1THENO$="You swing at him with your "+WP$+" but he jumps nimbly aside."
1430 IFX=2THENO$="He ducks skillfully under your blow!"
1440 IFX=3THENO$="You lunge at him but he ducks under your blow!"
1450 IFX=4THENO$="Your "+WP$+" misses him by a mile!"
1460 IFX=5THENO$="Your "+WP$+" flies over his head!"
1470 GOSUB8420
1480 GOSUB7000
1490 GOTO740
1500 G(3)=(ST/25)+1:G(3)=(G(3)*HT)
1510 G(5)=G(3)*(MH*(1/100))
1520 G(3)=G(3)-G(5)
1530 G(4)=G(3)/4:G(3)=G(3)-(G(4)*RND(1))+G(4)
1540 G(3)=INT(G(3))
1550 X=INT(6*RND(1))+3
1560 IFI$="C"THENO$="Your "+S$(Y)+" spell "+B$(X)+"s the monster doing "+STR$(G(3))+" damage!":GOSUB8420:GOSUB7000:GOTO1600
1570 O$="You "+B$(X)+" him with your "+WP$+" doing "+STR$(G(3))+" damage!"
1580 GOSUB8420
1590 GOSUB7000
1600 A9=A9-G(3):IFA9>0THEN740
1610 O$=DL$+"You've killed "+B$(1)+"!"+EL$
1620 O$=O$+EL$+"You gain "+STR$(A6)+" gold and "+STR$(A5)+" exp!"+EL$:GOSUB7000
1630 QA=0:AM=0
1640 IFMO$="Y"THEN1680
1650 IFWE<A3THENO$=EL$+"You also get his "+MW$+"!":G(0)=WE:WE=A3:A3=G(0):AM=1:GOSUB7000:WP$=MW$:HT=MP:GOTO1670
1660 O$=EL$+"You also get "+STR$(B(2))+" gold for his "+MW$+"!":GD=GD+B(2):GOSUB8420:GOSUB7000
1670 IFA4>ARTHENG(0)=AR:AR=A4:A4=G(0):O$=DL$+"You get his "+MH$+"!":QA=1:GOSUB7000:AM$=MH$:AP=MH
1680 GD=GD+A6:EX=EX+A5:A9=A0:A6=0:B$(2)="Dead"
1690 O$=EL$:GOSUB7000
1700 IFMO$="Y"THEN1750
1710 IFAC$="Y"THEN1750
1720 POKE2,255
1730 O$=EL$+"Leave Message to "+B$(1)+"?"+EL$+"Y/N: ":GOSUB6000:POKE1,128:B$(4)="No Comment.":IFI$="Y"THENO$=EL$+"40 Char. Max"+DL$:GOSUB6000:B$(4)=I$
1740 POKE2,0:POKE1,0
1750 IFFI>0ANDMO$="Y"THEN2870
1760 IFMO$="Y"THEN100
1770 GOSUB8380:B$(8)=NA$:G(1)=A:A=FI:GOSUB150:AR=A4:WE=A3:EX=A5:GD=A6:HP=A0:FI$=B$(2):B$(0)=DA$:DA$=I$:IFAC$<>"Y"THEN1790
1780 IFX<>-99THENNC=INT(BA/2):BA=NC-BA:AG=AG-(AG*2):FI$=NC$
1790 GOSUB8380:DA$=B$(0)
1800 IFAC$="Y"THEN1820
1810 O$=DL$:GOSUB7000:IFB$(2)="Dead"THENGOSUB1870
1820 A=G(1):GOSUB150
1830 GOSUB8670
1840 IFB$(2)<>"Dead"THENGOTO8370
1850 IFAC$="Y"THEN9370
1860 GOTO100
1870 PRINTD$"OPENDEATH,L50"C$(6)
1880 PRINTD$"WRITEDEATH,R"A
1890 PRINTG(1):PRINTQA""AM:PRINTB$(4)
1900 PRINTD$"CLOSE"
1910 PRINTD$"OPENRANK,L4"C$(11):PRINTD$"READRANK,R"A:INPUTX:PRINTD$"CLOSE":PRINTD$"OPENTOP,L35"C$(16):PRINTD$"READTOP,R"X:INPUTD$(1),D$(2),D$(3):PRINTD$"CLOSE"
1920 PRINTD$"OPENTOP,L35":PRINTD$"WRITETOP,R"X:PRINT"D":PRINTD$(2):PRINTD$(3):PRINTD$"CLOSE"
1930 RETURN
1940 HOME:O$=SC$:GOSUB7000:O$=DL$+DL$+"What level do you wish to enter:"+DL$+"1) Easy"+EL$+"2) Medium"+EL$+"3) Hard"+EL$+"4) Extremely hard"+EL$+"5) Crazy"+EL$+"6) Suicidal"+EL$
1950 O$=O$+"7) Instaneaneous Death"+EL$+"8) Half-Way to Hell"+EL$+"9) The Dead Zone"+EL$+"10) The Land of the Immortals"+DL$
1960 O$=O$+"Which(Q quits): ":GOSUB6000
1970 GOSUB200
1980 X=VAL(I$)
1990 IFX<1ORX>(CN/20)THEN1940
2000 FO=FO+1
2010 X=X-1
2020 X=(X*20)+1
2030 X=INT(20*RND(1))+X
2040 PRINTD$"OPENMONSTERS,L60"C$(9)
2050 PRINTD$"READMONSTERS,R"X
2060 INPUTB$(1),A7,A2,A8,A3,A4,A6,S1,S2,A9
2070 PRINTD$"CLOSE"
2080 A5=(((A9/TH)*8)/100)*EX:A5=INT(A5)+100:IFNE$="T"THENNE$="Y":GOTO2100
2090 NE$="N"
2100 GOSUB8870
2110 IFMO$="R"THENA6=A6*2:A5=A5*2:MO$="Y"
2120 O$=DL$+"A vicious "+B$(1)+" attacks you!":GOSUB8420:GOSUB7000:B$(1)="A "+B$(1):GOTO710
2130 IFNE$="Y"THENO$=EL$+"Sorry, Negate has been activated.  All  spells are impotent.":GOSUB7000:GOTO1210
2140 O$=EL$+"Cast(?): ":GOSUB6000
2150 IFI$<>"?"THENO$=I$:GOSUB8880:GOTO2200
2160 O$=EL$+"Name / Quantity / Power Required"+EL$+"--------------------------------"+DL$:GOSUB7000
2170 FORX=1TOSN:IFS(X)>0THENO$=S$(X)+"-"+STR$(S(X))+" ("+STR$(X*2)+")"+EL$:GOSUB7000
2180 NEXT
2190 GOTO2130
2200 FORX=1TOSN:IFS$(X)=B$(0)THEN2240
2210 NEXT
2220 IFB$(2)="CO"THENO$=EL$+"There is no such spell!":GOSUB7000:GOTO2880
2230 O$=EL$+"There is no such spell!":GOSUB7000:GOTO1210
2240 IFS(X)=0ANDB$(2)="CO"THENO$=EL$+"You don't have that spell!":GOSUB7000:GOTO2880
2250 IFS(X)=0THENO$=EL$+"You don't have that spell!":GOSUB7000:GOTO1210
2260 IFB$(2)="CO"AND(U(X)>0ORS$(X)="Negate")THENO$+EL$+"Sorry, that is a battle spell.":GOSUB7000:GOTO2860
2270 IFS$(X)="Inviso"ANDB$(2)="CO"THENO$=EL$+"Sorry, that is an Adventure spell.":GOSUB7000:GOTO2860
2280 IFB$(2)="CO"THEN2980
2290 IFS$(X)="Death"ORS$(X)="Negate"THEN2310
2300 IFU(X)<1THENO$=EL$+"Not a Battle spell!":GOSUB7000:GOTO1210
2310 IFPO<(X*2)THENO$=EL$+"You don't have enough power!":GOSUB7000:GOTO1210
2320 PO=PO-(X*2)
2330 S(X)=S(X)-1
2340 O$=EL$+"Zap!"+DL$:GOSUB7000:I$="C"
2350 Y=X
2360 IFS$(X)="Death"THENG(3)=A9/2:GOTO1540
2370 IFS$(X)="Negate"THENNE$="Y":O$="Negate has been activated.  All magical spells are impotent for the duration of this battle.":GOSUB7000:GOTO740
2380 G(3)=(WI/25)+1:G(3)=(G(3)*U(X)):GOTO1510
2390 IF(S1<2ANDS2<2)ORNE$="Y"THEN770
2400 G(8)=0
2410 IFS1<2THENG(8)=S2
2420 IFS2<2THENG(8)=S1
2430 IFG(8)<>0THEN2470
2440 X=INT(2*RND(1))+1
2450 IFX=1THENG(8)=S1
2460 IFX=2THENG(8)=S2
2470 IFS$(G(8))="Death"THENG(3)=HP/2:GOTO950
2480 G(3)=(A8/25)+1:G(3)=(G(3)*U(G(8))):GOTO920
2490 O$=EL$+"Once you enter the corridor there will  be few chances to leave.  Play? Y/N->":GOSUB6000:IFI$<>"Y"THEN230
2500 G(3)=LE*LE*60:O$=EL$+"Gold +"+STR$(G(3))+EL$:GOSUB7000:GD=GD+G(3)
2510 FORX=WN-MS+1TOWN:IFX>WETHEN2530
2520 NEXT
2530 X=(102-X):X=X*20:X=X-1:G(3)=CN+20-X:G(2)=1
2540 O$=EL$+"You can start anywhere from room "+STR$(G(2))+" to room "+STR$(G(3))+".":GOSUB8420:GOSUB7000
2550 ONERRGOTO2570
2560 GOTO2580
2570 CALL-3288
2580 O$=DL$+"Enter Starting Room #":GOSUB6000
2590 X=VAL(I$):IFX<G(2)ORX>G(3)THEN2580
2600 IFG(3)+20>CNTHEN2620
2610 O$=EL$+"The closest magical weapon and armor    lie in room #"+STR$(G(3)+20)+"."+EL$:GOSUB7000
2620 FI=X-1:FO=FI
2630 MO$="R":GOSUB680:MO$="Y"
2640 FI=FI+1
2650 ONERRGOTO2670
2660 I$="":GOTO2680
2670 CALL-3288:GOTO2880
2680 FORX=21TOCN+1STEP20:IFFI=XTHEN2710
2690 NEXT
2700 GOTO2820
2710 O$=EL$+"As you continue on your perilous quest  you notice a door to the west.  This    may be your only chance to leave."+EL$+"Quit? Y/N: ":GOSUB6000
2720 IFI$<>"Y"ANDI$<>"N"THEN2710
2730 IFI$="Y"THEN130
2740 T=MS:Y=T-1
2750 FORX=CN-(Y*20)TOCNSTEP20
2760 T=T-1:IFX=FI-1THENX=T:GOTO2790
2770 NEXT
2780 GOTO2820
2790 IFWE<WN-XTHENWE=WN-X:T=WE:GOSUB40:O$=EL$+"You Get a "+B$(0)+EL$:WP$=B$(0):HT=B(4):GOSUB7000
2800 IFAR<AN-XTHENAR=AN-X:T=AR:GOSUB60:O$=EL$+"You Get a "+B$(0)+EL$:AM$=B$(0):AP=B(4):GOSUB7000
2810 IFFI=CN+1THEN130
2820 IFAC$="Y"THENO$=DL$+"["+B$(1)+"'s Castle]"+DL$+"Room "+STR$(FI)+DL$:GOSUB7000:B$(2)="C":IFT>0THENX=T:GOTO2040
2830 IFAC$="Y"THEN2880
2840 O$=DL$+"[Corridor of Death]"+DL$+"Room "+STR$(FI)+DL$:GOSUB7000
2850 B$(2)="C"
2860 IFFI<>FOTHENX=FI:FO=FI:GOTO2040
2870 B$(2)="CO"
2880 GOSUB8300:O$=DL$+"[Tm:"+STR$(TL)+"/C)ast H)ealth M)ove S)tats]->":GOSUB6000:CALL54915
2890 IFI$="S"THENGOSUB3210
2900 IFI$="M"THENFD=FD-3:IFFD<1THENFD=0:O$=EL$+"You're starving!"+DL$+"Hit points -"+STR$(LE)+EL$:GOSUB7000:HP=HP-LE
2910 IFFD>0ANDFD<10THENO$=EL$+"Warning!  You are low on food!"+EL$:GOSUB7000
2920 IFHP<1THENO$=EL$+"You died of starvation!"+DL$+"Monsters come by and rob you of all     your gold!"+EL$:GOSUB7000:GD=0:GOTO8370
2930 IFI$="H"THENGOSUB8660
2940 IFI$="C"THEN2130
2950 IFI$="M"ANDAC$="Y"THENFI=FI+1:GOTO8980
2960 IFI$="M"THEN2640
2970 GOTO2880
2980 IFPO<(X*2)THENO$=EL$+"You don't have enough power!":GOSUB7000:GOTO2880
2985 IFAC$="Y"ANDS$(X)="Resurrect"THENO$=EL$+"Sorry, you cannot cast that spell insidea castle.":GOSUB7000:GOTO2880
2990 IFS$(X)="Resurrect"ANDB$="Y"THENO$=EL$+"Resurrect has already been Activated!"+EL$:GOSUB7000:GOTO2880
3000 PO=PO-(X*2):S(X)=S(X)-1
3010 O$=EL$+"Alakazam!!!"+EL$:GOSUB7000
3020 IFS$(X)="Teleport"THENO$=EL$+"Zap!  You are teleported to safety!"+EL$:GOSUB7000:FO=4:GOTO130
3030 IFS$(X)<>"Protect"ANDS$(X)<>"Super Protect"THEN3070
3040 IFS$(X)="Protect"THENG(6)=G(6)+10:O$="Protect "
3050 IFS$(X)="Super Protect"THENG(6)=G(6)+20:O$="Super Protect "
3060 O$=EL$+O$+"has been Activated"+DL$+"Estimated Lasting Time ["+STR$(G(6))+"] Hits":GOSUB7000:GOTO2880
3070 IFS$(X)="Resurrect"THENB$="Y":O$=EL$+"Resurrect has been Activated."+EL$:GOSUB7000:GOTO2880
3080 IFS$(X)="Super Increase"THENHP=TH*2:PO=TP*2:O$=EL$+"Hit Points = "+STR$(HP)+"!"+DL$+"Power = "+STR$(PO)+"!"+EL$:GOSUB7000:GOTO2880
3090 IFS$(X)<>"Increase"THEN3140
3100 O$=EL$+"[H/it points-P/ower]->":GOSUB6000:IFI$<>"H"ANDI$<>"P"THEN3100
3110 IFI$="H"THENHP=TH*2:O$=EL$+"Hit points = "+STR$(HP)
3120 IFI$="P"THENPO=TP*2:O$=EL$+"Power = "+STR$(PO)
3130 O$=O$+"!":GOSUB7000:GOTO2880
3140 IFS$(X)="Cure Light Wounds"THENG(3)=INT(10*RND(1))+1:G(4)=INT(10*RND(1))+1
3150 IFS$(X)="Cure Severe Wounds"THENG(3)=INT(20*RND(1))+10:G(4)=INT(20*RND(1))+10
3160 IFS$(X)="Cure All Wounds"THENHP=TH:PO=TP:O$=EL$+"All Hit Points and Power restored!":GOSUB7000:GOTO2880
3170 O$=EL$+"Hit points +"+STR$(G(3))+DL$+"Power +"+STR$(G(4)):HP=HP+G(3):PO=PO+G(4):IFHP>THTHENHP=TH
3180 IFPO>TPTHENPO=TP
3190 GOSUB7000
3200 GOTO2880
3210 O$=EL$+"Strength: "+STR$(ST)+EL$+"Wisdom: "+STR$(WI)+EL$+"Agility: "+STR$(AG)+EL$+"Intelligence: "+STR$(CH)+EL$+EL$+"Gold: "+STR$(GD)+EL$+"Exp: "+STR$(EX)+EL$+EL$+"Weapons: "+WP$+EL$+"Armor: "+AM$+EL$
3220 O$=O$+EL$+"Protection Left: "+STR$(G(6))+" Hits"
3230 O$=O$+EL$+"Resurrect: "
3240 I$="Off"
3250 IFB$="Y"THENI$="On"
3260 O$=O$+I$
3270 GOSUB7000
3280 RETURN
3290 A$=CH$:GOSUB8850:CALL35848"CHAT"
6000 GOSUB7000:GOSUB8000:RETURN
7000 &B/O$:POKE960,0:RETURN
8000 CC=0:IFPEEK(1)=128ANDCF=1ANDCA$="Y"THENCA$="N":CALL38539:CF=9
8010 IFCF=9ANDPEEK(1)<>128THENCF=1:CA$="Y"
8020 IFCA$<>"Y"ORLEN(CN$)>1THEN8040
8030 IFCF=1THENCALL38539
8040 IFPEEK(1)=128THEN8140
8050 IFLEN(CN$)=0THEN8140
8060 FORT=1TOLEN(CN$)
8070 IFMID$(CN$,T,1)=","THENI$=MID$(CN$,1,T-1):CN$=RIGHT$(CN$,LEN(CN$)-T):GOTO8110
8080 IFMID$(CN$,T,1)="#"THENI$=MID$(CN$,1,T-1):CN$="":GOTO8110
8090 NEXT
8100 POKE960,0
8110 IFO$="STOP"THENO$="":GOTO8210
8120 IFLEN(I$)=0THEN8050
8130 O$=I$+EL$:GOSUB7000:GOTO8290
8140 POKE960,0:&A/SP$:I$=MID$(SP$,1):IFPEEK(961)THEN3290
8150 CN$=I$+"#":O$="STOP"
8160 IFLEFT$(I$,1)="#"THENI$="#":CN$=""
8170 POKE961,0:IFPEEK(960)=255THENCC=CC+1:FORT=1TO500:NEXT:IFCC>1ORI$="OFF"THEN8370
8180 IFPEEK(960)=255THEN8140
8190 IFPEEK(1)=128THENCN$="":GOTO8230
8200 IFLEN(CN$)>0THEN8060
8210 IFLEN(I$)<>1ANDRIGHT$(I$,1)=" "THENI$=LEFT$(I$,LEN(I$)-1):GOTO8210
8220 IFLEN(I$)<>1ANDLEFT$(I$,1)=" "THENI$=RIGHT$(I$,LEN(I$)-1):GOTO8220
8230 IFLEN(I$)=0ANDCR=1THENO$=EL$:GOSUB7000:GOTO8250
8240 IFLEN(I$)=0THEN8000
8250 IFCA$<>"Y"THEN8290
8260 IFCF=1THENCALL36798
8270 IFI$="202 ON"THENO$=EL$+"202 is now On.":GOSUB7000:CALL36798:CF=1
8280 IFI$="202 OFF"THENO$=EL$+"202 is now Off.":GOSUB7000:CALL38539:CF=0
8290 CR=0:RETURN
8300 IFCL$="N"THENT$=DA$:RETURN
8310 PR#4:IN#4:INPUT"#";T,T,T,T,T,B:INPUT"%";T$
8320 PR#0:POKE56,102:POKE57,213:CALL1002
8330 IFTI>TTHENT=TI+(60-TI)+T
8340 TL=CO-(T-TI)
8350 IFTL<=0THENO$=EL$+"You are out of Time!  Later.":GOSUB7000:GOTO8370
8360 RETURN
8370 A$=OF$:GOSUB8850:CALL35848"OFF"
8380 PRINTD$"OPENSTATS,L200"C$(15):PRINTD$"WRITESTATS,R"A:PRINTNA$:PRINTFI$:PRINTLE:PRINTAG:PRINTWE:PRINTAR:PRINTEX:PRINTGD:PRINTST:PRINTTH:PRINTHP:PRINTPA$:PRINTWI:PRINTCH:PRINTLS:PRINTCA:PRINTCL:PRINTAD$:PRINTCP
8390 PRINTFD:PRINTPO:PRINTTP:PRINTBA:PRINTPA:PRINTDE:PRINTDA$
8400 FORX=1TOSN:PRINTS(X):NEXT
8410 PRINTD$"CLOSE":RETURN
8420 IFLEN(O$)<40THEN8520
8430 Y=40
8440 X=0
8450 IFMID$(O$,Y-X,1)=" "THENB$(0)=LEFT$(O$,(Y-1)-X):B$(0)=B$(0)+EL$+RIGHT$(O$,LEN(O$)-(Y-X)):GOTO8470
8460 X=X+1:GOTO8450
8470 O$=B$(0)
8480 IF(Y+40)>LEN(O$)THEN8520
8490 Y=Y+39
8500 Y=(Y-X)+1
8510 GOTO8440
8520 RETURN
8530 PRINT:PRINTD$"OPEND-"B$(1)C$(20)
8540 PRINTD$"APPENDD-"B$(1)
8550 PRINTD$"WRITED-"B$(1)
8560 PRINT"You Killed "+NA$+" On "+DA$
8570 PRINT
8580 PRINT"You got "+STR$(GD)+" Gold."
8590 PRINT"You got "+STR$(EX)+" Experience."
8600 IFAM=1THENPRINT"You also got his "+WP$
8610 IFAM<>1THENPRINT"You also got "+STR$(B(1))+" gold for his weapon.":GD=GD+B(1)
8620 IFQA=1THENPRINT"You also got his "+AM$:QA=0
8630 PRINT
8640 PRINT
8650 PRINTD$"CLOSE":RETURN
8660 O$=EL$+"Hit Points: "+STR$(HP)+" out of "+STR$(TH)+EL$+"     Power: "+STR$(PO)+" out of "+STR$(TP)+EL$+"      Food: "+STR$(FD):GOSUB7000:RETURN
8670 PRINTD$"OPENCSTAT"C$(17)
8680 PRINTD$"APPENDCSTAT"
8690 PRINTD$"WRITECSTAT"
8700 B$(3)="["+NA$+"]  VS  ["+B$(1)+"]"
8710 X=(40-LEN(B$(3)))/2
8720 O$=""
8730 FORY=1TOX:O$=O$+" ":NEXT:O$=O$+B$(3)
8740 PRINTO$
8750 PRINT
8760 IFB$(2)<>"Dead"THENB$(3)="["+B$(1)+"]":GOTO8780
8770 B$(3)="*<-"+NA$+"->*"
8780 X=(40-LEN(B$(3)))/2
8790 O$=""
8800 FORY=1TOX:O$=O$+" ":NEXT:O$=O$+B$(3)
8810 PRINTO$
8820 PRINT:PRINT
8830 PRINTD$"CLOSE"
8840 RETURN
8850 Y=VAL(MID$(A$,4,1)):POKE43626,Y:Y=VAL(RIGHT$(A$,1)):POKE43624,Y:Y=VAL(LEFT$(A$,3)):IFYR$="Y"THENPRINTD$"OPEN VC,V"Y
8855 IFTC$="Y"THENPOKE1014,10:POKE952,215:POKE953,251
8860 RETURN
8870 T=A3:GOSUB40:B(2)=T:MP=B(4):MW$=B$(0):T=A4:GOSUB60:MH=B(4):MH$=B$(0):RETURN
8880 B$(0)="":J=0
8890 FORX=1TOLEN(O$)
8900 A$=MID$(O$,X,1)
8910 IFX=1THEN8950
8920 T=ASC(A$):IFT<65ORT>90THENJ=1:GOTO8950
8930 IFJ=1THENJ=0:GOTO8950
8940 T=T+32:A$=CHR$(T)
8950 B$(0)=B$(0)+A$
8960 NEXT
8970 RETURN
8980 IFFI<>20THEN9030
8990 O$=EL$+"You enter the treasure room of this     treacherous castle, estatic that your   quest is nearly complete.  But wait...  It appears you are not alone in the     room!  It seems that the owner of this"
9000 O$=O$+EL$+"Castle is present.  He speaks:  ":GOSUB7000:O$=DL$+"'How dare you disturb my castle!  You   Shall Die a Cruel death Scum!!!"+EL$:GOSUB7000
9010 G(6)=0:IFHP>THTHENHP=TH
9020 B$(2)="":MO$="N":X=NC:GOSUB390:X=NC:B$(2)="On":GOTO660
9030 A$=LEFT$(D$(FI),1)
9040 B$=RIGHT$(D$(FI),1)
9050 T=0
9060 O$=DL$+"["+C$+"'s Castle]"+DL$+"Room "+STR$(FI)+DL$:GOSUB7000:B$(2)="C"
9070 IFA$="0"THEN9100
9080 X=ASC(A$)-65:X=X*20:T=INT(20*RND(1))+X
9090 Y=0
9100 IFB$="0"THEN9150
9110 G(8)=ASC(B$)-64:Y=-99:GOSUB2470
9120 O$=EL$+"You walk into a trap!"+DL$:GOSUB7000:O$="A "+S$(G(8))+" Spell hit's you doing "+STR$(G(3))+" damage."+EL$:GOSUB8420:GOSUB7000:HP=HP-G(3)
9130 IFHP<1THENO$=EL$+"You are Dead!"+EL$:GOTO1110
9140 IFG(3)=0ANDT>0THENNE$="T"
9150 IFT>0THENX=T:O$=DL$+"There is a monster in the room.....":GOSUB7000:GOTO2040
9160 O$=EL$+"Phew!  The room appears to be empty...":GOSUB7000:GOTO2870
9170 O$=EL$+"Enter Castle # to Attack(1-"+STR$(US)+")->":GOSUB6000
9180 IFI$="Q"THEN220
9190 X=VAL(I$):IFX<1ORX>USTHEN9170
9200 IFA=XTHEN9170
9210 AC$="Y":NC=X
9220 ONERRGOTO9250
9230 PRINTD$"OPENCASTLES,L39"C$(12):PRINTD$"READCASTLES,R"X:INPUTCS$:PRINTD$"CLOSE"
9240 GOTO9260
9250 CALL-3288:GOSUB9380
9260 GOSUB400
9270 IFY=-99THENY=0:O$=DL$+"Sorry, that persons Castle has already  been robbed."+EL$:GOSUB7000:GOTO9170
9280 IFLE>A1+FLTHENO$=EL$+"You can only attack a User that is "+STR$(FL)+" levels below you or higher."+EL$:GOSUB8420:GOSUB7000:GOTO9170
9290 IFB$(1)="Empty"THENO$=EL$+"Sorry, that user has been deleted."+EL$:GOTO9170
9300 O$=EL$+"Attack "+B$(1)+"'s Castle Y/N->":GOSUB8420:GOSUB6000:IFI$<>"Y"THEN9170
9310 Y=0
9320 FORX=1TO38STEP2
9330 Y=Y+1:D$(Y)=MID$(CS$,X,2)
9340 NEXT
9350 MO$="R":GOSUB680:MO$="Y":C$=B$(1):NC$=B$(2)
9360 FI=1:B$(2)="C":GOTO8980
9370 O$=EL$+"You get half of "+C$+"'s Treasure which amounts to $"+STR$(NC)+" Gold Pieces!"+EL$:GOSUB8420:GOSUB7000:GD=GD+NC:FO=4:GOTO130
9380 CS$="00000000000000000000000000000000000000":RETURN