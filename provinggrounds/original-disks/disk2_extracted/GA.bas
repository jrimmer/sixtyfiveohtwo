2088 
9283 ="Y"THENPOKE1014,0:POKE952,240:POKE953,253
10 CALL54915
20 IFA>0THEN40
30 PRINTCHR$(4)"SAVEGA,S3":PRINTCHR$(4)"RUNSTORES,S6"
40 AM=0
50 D=1
60 J=A
70 ONERRGOTO90
80 GOTO120
90 CALL-3288:GOTO130
100 O$=DL$+"-=>HOLD...Transport Heading to Main."+EL$:GOSUB7000
110 A$=MA$:A=J:GOSUB8390:CALL35848"MAIN"
120 HOME:O$=SC$+DL$+DL$+EL$:GOSUB7000
130 GOSUB8300:O$=DL$+"Welcome to Rebel's Hideout"+DL$+"What do you want to play...."+DL$+"B) lackjack"+EL$+"R) Roulette"+EL$+"S) Slots"+EL$+"Z) Russian Roulette"+DL$+"[B/R/S/Z/Q]->":GOSUB6000
140 IFI$="Q"THEN100
150 FORX=1TO9:G(X)=0:NEXTX
160 IFI$="Z"THEN1720
170 IFI$="R"THEN750
180 IFI$="S"THEN210
190 IFI$="B"THEN1180
200 GOTO130
210 O$=DL$+"You saunder over to a group of slot     machines and notice, to your surprise,  that you have three choices:"
220 GOSUB7000
230 O$=DL$+"A) 3-wheeled slot"+EL$+"B) 4-wheeled slot"+EL$+"C) 5-wheeled slot"+DL$+"[A/B/C/<Q>uit]->":GOSUB6000
240 X=INT(3*RND(1))+1
250 GOSUB1670
260 IFI$="A"THENG(0)=3
270 IFI$="B"THENG(0)=4
280 IFI$="C"THENG(0)=5
290 IFG(0)<3ORG(0)>5THEN230
300 O$=EL$+"You have ["+STR$(GD)+"] gold pieces."+DL$+"[Enter Bet/<Q>uit]->":GOSUB6000
310 GOSUB1670
320 I$=STR$(INT(VAL(I$)))
330 GOSUB1690:IFBE=1THENBE=0:GOTO300
340 GD=GD-VAL(I$)
350 GOSUB8380
360 O$=EL$:GOSUB7000
370 FORSP=G(0)TO1STEP-1
380 FORY=1TO7
390 O$=""
400 FORX=1TOSP
410 C=INT(9*RND(1))+1
420 O$=O$+STR$(C)
430 IFX=SPTHENO(SP)=C
440 NEXTX
450 FORX=1TOSP
460 O$=O$+CHR$(8)
470 NEXTX
480 GOSUB7000
490 NEXTY
500 O$=STR$(O(SP)):GOSUB7000
510 NEXTSP
520 SP=0
530 FORX=1TOG(0)
540 FORY=1TO9
550 IFO(X)=YTHENG(Y)=G(Y)+1
560 NEXTY
570 NEXTX
580 FORY=1TO9:IFG(Y)>=(INT(G(0)/2)+1)THENO$=DL$+"["+STR$(G(Y))+"] of a kind!"+EL$:GOSUB7000:SP=Y:Y=9
590 NEXT
600 IFSP>0THEN630
610 O$=DL$+"You lose sucker!"+EL$:GOSUB7000
620 FORX=1TO9:G(X)=0:NEXT:GOTO300
630 IFG(0)<>3THEN660
640 IFG(SP)=2THENY=2.75
650 IFG(SP)=3THENY=81
660 IFG(0)<>4THEN690
670 IFG(SP)=3THENY=36
680 IFG(SP)=4THENY=400
690 IFG(0)<>5THEN730
700 IFG(SP)=3THENY=10
710 IFG(SP)=4THENY=250
720 IFG(SP)=5THENY=4000
730 G(1)=INT(VAL(I$)*Y)
740 O$=EL$+"You win "+STR$(G(1)-VAL(I$))+" gold pieces!"+EL$:GD=GD+G(1):GOSUB7000:GOTO620
750 O$=DL$+"[<N>umber/<E>ven/<O>dd/<S>equence]"+DL$+"You have ["+STR$(GD)+"] Gold"+DL$+"[Which/<Q>uit]->":GOSUB6000
760 IFI$<>"N"ANDI$<>"E"ANDI$<>"O"ANDI$<>"S"ANDI$<>"Q"THEN750
770 GOSUB1670
780 FORX=1TO7:G(X)=0:NEXT
790 Y=0
800 IFI$="E"THENG(4)=1
810 IFI$="O"THENG(5)=1
820 IFI$<>"N"THEN870
830 O$=DL$+"[Select Number <1-36>:":GOSUB6000
840 GOSUB1670
850 IFVAL(I$)<1ORVAL(I$)>36THEN830
860 Y=VAL(I$)
870 IFI$<>"S"THEN960
880 O$=DL$+"[Select Starting #]:":GOSUB6000
890 GOSUB1670
900 IFVAL(I$)>36ORVAL(I$)<1THEN880
910 G(0)=VAL(I$)
920 O$=DL$+"[Select  Ending  #]:":GOSUB6000
930 GOSUB1670
940 IFVAL(I$)>36ORVAL(I$)<1THEN920
950 G(1)=VAL(I$)
960 O$=DL$+"How much do you want to bet: ":GOSUB6000
970 GOSUB1670
980 I$=STR$(INT(VAL(I$)))
990 GOSUB1690:IFBE=1THENBE=0:GOTO960
1000 G(2)=VAL(I$):GD=GD-VAL(I$)
1010 GOSUB8380
1020 O$=DL$+EL$:GOSUB7000
1030 O$="The ball is rolling...."
1040 O$=O$+TU$
1050 GOSUB7000
1060 G(3)=INT(36*RND(1))+1
1070 O$=DL$+EL$:GOSUB7000
1080 O$="The number is................"+STR$(G(3))+DL$:GOSUB7000
1090 IFY=G(3)THENG(7)=36*G(2)
1100 FORX=2TO36STEP2:IFG(3)=XTHENG(6)=1
1110 NEXT
1120 IFG(4)=1ANDG(6)=1THENG(7)=2*G(2)
1130 IFG(5)=1ANDG(6)=0THENG(7)=2*G(2)
1140 IFG(0)<=G(3)ANDG(1)=>G(3)THENG(7)=(36/((G(1)+1)-G(0)))*G(2)
1150 IFG(7)<1THENO$="Ha Ha Ha!  You lose sucker!":GOSUB7000
1160 IFG(7)>0THENO$="You win "+STR$(INT(G(7)-G(2)))+" pieces of gold!":GD=GD+INT(G(7)):GOSUB7000
1170 GD=INT(GD):GOTO750
1180 MO$="":O$=SC$+EL$+"[Blackjack]   By: The Chief Surgeon"+DL$+"Initializing...":GOSUB7000:POKE36728,32:B$(0)="    ":B$(2)="A234567890JQK":FORF=1TO4
1190 FORZ=1TO13:MO$=MO$+MID$(B$(2),Z,1)+MID$(B$(0),F,1):NEXT:NEXT:GOSUB1620:GOTO1210
1200 GOSUB7000
1210 O$=EL$:GOSUB7000:IFGD<1THENO$=EL$+"You lost all of your money!":GOSUB7000:GOTO130
1220 GD=INT(GD):O$=EL$+"You have: "+STR$(GD)+EL$+"Your bet: ":GOSUB6000:A=VAL(I$):IFA<0ORA>GDTHEN1210
1230 GOSUB8300
1240 A$=""
1250 IFI$="0"ORI$="Q"THEN130
1260 IFA=0THEN1210
1270 F$="":O$=EL$+"Dealer- "+"?? ":GOSUB7000:GOSUB1580:F$=ZZ$:A3=X:GOSUB1580:O$=ZZ$+" Total = ??":GOSUB7000
1280 F$=F$+ZZ$:A3=A3+X:A6=-1:GOSUB1580:A4=X:L1$=ZZ$:A5=-1:GOSUB1580:A4=A4+X:L1$=L1$+ZZ$
1290 O$=EL$+"Player- "+L1$+" Total = "+STR$(A4):GOSUB7000:A5=A5+1:IFA4<22THEN1330
1300 FORF=1TOLEN(L1$)STEP3:IFMID$(L1$,F,1)<>"A"THENNEXT:O$=EL$+"Player- Busted!":GD=GD-A:GOTO1200
1310 O$=EL$+"Player- Ace counts as one.":GOSUB7000:A4=A4-10:IFF>1THENL1$=LEFT$(L1$,F-1)+"1"+MID$(L1$,F+1):GOTO1290
1320 L1$="1"+MID$(L1$,F+1):GOTO1290
1330 IFA$="Y"THENA$="N":GOTO1440
1340 IFA4=21ANDNOTA5THENO$=EL$+"Player- Blackjack!":GD=GD+1.5*A+.5:GOTO1200
1350 O$=DL$+"Player- H)it S)tand":GOSUB7000:IFNOTA5THENO$=" D)ouble":GOSUB7000
1360 O$=EL$+"?: ":GOSUB6000
1370 IFI$<>"H"THEN1390
1380 O$=EL$+"Player- Hits":GOSUB7000:GOSUB1580:L1$=L1$+ZZ$:A4=A4+X:GOTO1290
1390 IFI$<>"D"ORA5THEN1420
1400 O$=EL$+"Player- Doubles":GOSUB7000:IF2*A>GDTHENO$=EL$+" but then decides that"+EL$+"        he hasn't got enough gold!":GOSUB7000:GOTO1290
1410 PRINT:A=2*A:A$="Y":I$="H":GOTO1370
1420 IFI$<>"S"THENO$=EL$+"Dealer- Can't understand that gibberish!":GOSUB7000:GOTO1350
1430 O$=EL$+"Player- Stands":GOSUB7000
1440 O$=DL$+"Dealer- "+F$+" Total = "+STR$(A3):GOSUB7000:A6=A6+1:IFA3<22THEN1490
1450 FORF=1TOLEN(F$)STEP3:IFMID$(F$,F,1)<>"A"THENNEXT:O$=EL$+"Dealer- Busted!":GD=GD+A:GOTO1200
1460 IFF=1THENF$="1"+MID$(F$,2)
1470 IFF<>1THENF$=LEFT$(F$,F-1)+"1"+MID$(F$,F+1)
1480 O$=EL$+"Dealer- Ace counts as one.":A3=A3-10:GOSUB7000:GOTO1440
1490 IFA3<17THENO$=EL$+"Dealer- Hits":GOSUB7000:GOSUB1580:F$=F$+ZZ$:A3=A3+X:GOTO1440
1500 IFA3<>17ORA6THEN1530
1510 FORF=1TOLEN(F$)STEP3:IFMID$(F$,F,1)="A"THENO$=EL$+"Dealer- Hits on soft seventeen (17)":GOSUB7000:GOSUB1580:F$=F$+ZZ$:A3=A3+X:GOTO1440
1520 NEXT
1530 IFA3=21ANDNOTA6THENO$=EL$+"Dealer- has Blackjack!":GOSUB7000
1540 O$=DL$+"Dealer- Total = "+STR$(A3)+EL$+"Plater- Total = "+STR$(A4)+EL$:GOSUB7000:IFA3=21THENO$=EL$+"Sorry, house always wins with 21!":GD=GD-A:GOTO1200
1550 IFA4=A3THENO$=EL$+"It's a push- oh well...":GOTO1200
1560 IFA4>A3THENO$=EL$+"Player- Wins!":GD=GD+A:GOTO1200
1570 O$=EL$+"Player- Loses...":GD=GD-A:GOTO1200
1580 IFNOTA7THENGOSUB1620
1590 ZZ$=LEFT$(B$,2)+" ":IFLEN(B$)>2THENB$=RIGHT$(B$,LEN(B$)-2)
1600 A7=A7-1:FORF=1TO9:IFLEFT$(ZZ$,1)<>MID$(B$(2),F,1)THENNEXT
1610 X=F+10*(F=1):RETURN
1620 F=FRE(0):O$=DL$+"New Deck: Shuffling..."+EL$:GOSUB7000:B$=MO$:MO$="":FORF=52TO2STEP-1:Y=INT(F*RND(1))*2:MO$=MO$+MID$(B$,Y+1,2)
1630 IFYANDY<F*2-2THENB$=LEFT$(B$,Y)+RIGHT$(B$,F*2-Y-2):GOTO1660
1640 IFNOTYTHENB$=RIGHT$(B$,F*2-2):GOTO1660
1650 IFY=LEN(B$)-2THENB$=LEFT$(B$,LEN(B$)-2)
1660 NEXT:MO$=MO$+B$:B$=MO$:A7=52:RETURN
1670 IFI$="Q"ORI$="0"THENPOP:GOTO130
1680 RETURN
1690 IFVAL(I$)<1THENO$=EL$+"[Positive Numbers Only!]":BE=1:GOSUB7000:RETURN
1700 IFVAL(I$)>GDTHENO$=EL$+YO$:BE=1:GOSUB7000:RETURN
1710 RETURN
1720 O$=EL$+"You walk over to The Russian Roulette   Table and pick up the Gun...":GOSUB7000
1730 G(0)=1
1740 G(1)=G(0)*(LE*LE*35):O$=DL$+"1) Pull The Trigger"+DL$+"[Gold in Pot:"+STR$(G(1))+"][Q]->":GOSUB6000
1750 GOSUB1670:GOSUB8300:IFI$<>"1"THEN1740
1760 O$=EL$+"You Pull The Trigger....":GOSUB7000:FORX=1TO750:NEXT
1770 G(0)=G(0)+1
1780 X=INT(2*RND(1))+1
1790 IFX=2THENO$="Bang!"+DL$+"You Are Dead.  You lose all your Gold!":GOSUB7000:GD=0:GOTO8370
1800 GD=GD+G(1)
1810 O$="Click!"+DL$+"Phew!....You win "+STR$(G(1))+" Gold!":GOSUB7000:GOTO1740
1820 A$=CH$:A=J:GOSUB8390:CALL35848"CHAT"
6000 GOSUB7000:GOSUB8000:RETURN
7000 &B/O$:POKE960,0:RETURN
8000 CC=0:IFPEEK(1)=128ANDCF=1ANDCA$="Y"THENCA$="N":CALL38539:CF=9
8010 IFCF=9ANDPEEK(1)<>128THENCF=1:CA$="Y"
8020 IFCA$<>"Y"ORLEN(CN$)>1THEN8040
8030 IFCF=1THENCALL38539
8040 IFPEEK(1)=128THEN8140
8050 IFLEN(CN$)=0THEN8140
8060 FORT=1TOLEN(CN$)
8070 IFMID$(CN$,T,1)=","THENI$=MID$(CN$,1,T-1):CN$=RIGHT$(CN$,LEN(CN$)-T):GOTO8110
8080 IFMID$(CN$,T,1)="#"THENI$=MID$(CN$,1,T-1):CN$="":GOTO8110
8090 NEXT
8100 POKE960,0
8110 IFO$="STOP"THENO$="":GOTO8210
8120 IFLEN(I$)=0THEN8050
8130 O$=I$+EL$:GOSUB7000:GOTO8290
8140 POKE960,0:&A/SP$:I$=MID$(SP$,1):IFPEEK(961)THEN1820
8150 CN$=I$+"#":O$="STOP"
8160 IFLEFT$(I$,1)="#"THENI$="#":CN$=""
8170 POKE961,0:IFPEEK(960)=255THENCC=CC+1:IFCC>1THEN8440
8180 IFPEEK(960)=255ORI$="OFF"THEN8370
8190 IFPEEK(1)=128THENCN$="":GOTO8230
8200 IFLEN(CN$)>0THEN8060
8210 IFLEN(I$)<>1ANDRIGHT$(I$,1)=" "THENI$=LEFT$(I$,LEN(I$)-1):GOTO8210
8220 IFLEN(I$)<>1ANDLEFT$(I$,1)=" "THENI$=RIGHT$(I$,LEN(I$)-1):GOTO8220
8230 IFLEN(I$)=0ANDCR=1THENO$=EL$:GOSUB7000:GOTO8250
8240 IFLEN(I$)=0THEN8000
8250 IFCA$<>"Y"THEN8290
8260 IFCF=1THENCALL36798
8270 IFI$="202 ON"THENO$=EL$+"202 is now On.":GOSUB7000:CALL36798:CF=1
8280 IFI$="202 OFF"THENO$=EL$+"202 is now Off.":GOSUB7000:CALL38539:CF=0
8290 CR=0:RETURN
8300 IFCL$="N"THENT$=DA$:RETURN
8310 PR#4:IN#4:INPUT"#";T,T,T,T,T,B:INPUT"%";T$
8320 PR#0:POKE56,102:POKE57,213:CALL1002
8330 IFTI>TTHENT=TI+(60-TI)+T
8340 TL=CO-(T-TI)
8350 IFTL<=0THENO$=EL$+"You are out of Time!  Later.":GOSUB7000:GOTO8370
8360 RETURN
8370 A$=OF$:A=J:GOSUB8390:CALL35848"OFF"
8380 GOSUB8300:RETURN
8390 Y=VAL(MID$(A$,4,1)):POKE43626,Y:Y=VAL(RIGHT$(A$,1)):POKE43624,Y:Y=VAL(LEFT$(A$,3)):IFYR$="Y"THENPRINTD$"OPEN VC,V"Y
8395 IFTC$="Y"THENPOKE1014,10:POKE952,215:POKE953,251
8400 RETURN